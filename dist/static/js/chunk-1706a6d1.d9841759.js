(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1706a6d1"],{4206:function(e,t,n){},"8db0":function(e,t,n){},"9cb0":function(e,t,n){"use strict";var i=n("8db0"),a=n.n(i);a.a},c19f:function(e,t,n){"use strict";var i=n("4206"),a=n.n(i);a.a},ce6b:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ef-annotation-container"},[n("div",{staticClass:"ef-annotation-header"},[n("el-row",[n("el-col",{attrs:{span:8}},[n("div",{staticClass:"ef-anno-botname"},[n("span",[n("b",[e._v("机器人名:")])])])]),n("el-col",{attrs:{span:16}},[n("div",{staticClass:"ef-anno-buttons",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"success",round:"",size:"mini"},on:{click:e.handleAddExample}},[e._v("添加新样本")]),n("el-button",{attrs:{type:"warning",round:"",size:"mini"}},[e._v("智能标注")]),n("div",{staticStyle:{display:"inline-block",margin:"0px 5px 0px 5px"}},[n("el-upload",{staticClass:"upload-demo",attrs:{name:"upfile",action:"123","before-upload":e.beforeTrainFileUpload,"show-file-list":!1,"on-success":e.fileuploadsucess,"on-error":e.fileuploadfail}},[n("el-button",{attrs:{round:"",size:"mini",icon:"el-icon-upload2"}},[e._v("批量上传")])],1)],1),n("el-button",{attrs:{type:"primary",round:"",size:"mini",icon:"el-icon-download"},on:{click:e.download}},[e._v(" 下载标注结果")]),n("el-button",{attrs:{type:"danger",round:"",size:"mini"}},[e._v("清空")])],1)])],1)],1),n("div",{staticClass:"ef-annotation-body"},[n("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"","highlight-current-row":"",data:e.AfterChanageData,"row-style":{height:"45px"},"cell-style":{padding:"0px"},"max-height":e.tableHeight,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{label:"ID",sortable:"",prop:"id",width:"100"}}),n("el-table-column",{attrs:{label:"intent",sortable:"",prop:"intent",width:"200"}}),n("el-table-column",{attrs:{label:"text",sortable:"",prop:"text"}}),n("el-table-column",{attrs:{type:"expand",width:"1"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v("伸缩面板占位")])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{directives:[{name:"show",rawName:"v-show",value:-1===t.row.check,expression:"scope.row.check===-1"}],staticClass:"el-icon-error",staticStyle:{color:"#F56C6C","font-size":"20px"}}),n("i",{directives:[{name:"show",rawName:"v-show",value:1===t.row.check,expression:"scope.row.check===1"}],staticClass:"el-icon-success",staticStyle:{color:"#67C23A","font-size":"20px"}}),n("i",{directives:[{name:"show",rawName:"v-show",value:0===t.row.check,expression:"scope.row.check===0"}],staticClass:"el-icon-question",staticStyle:{color:"#909399","font-size":"20px"}}),e._v("\n                      \n                    "),n("el-button",{staticStyle:{"font-size":"20px"},attrs:{type:"text",icon:"el-icon-setting "},on:{click:function(n){return e.toogleExpand(t.row)}}})]}}])}),n("el-table-column",{attrs:{type:"expand",width:"1"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("slider",{attrs:{query:t.row.text,frames:t.row.entities,slotnames:[]}}),n("div",{staticStyle:{"text-align":"right",width:"100%",margin:"0px 2px 0px 2px"}},[n("el-button",{attrs:{round:"",type:"info",size:"mini"},on:{click:function(n){return e.handleIgnoreExample(t.$index)}}},[e._v(" Ignore ")]),n("el-button",{attrs:{round:"",type:"success",size:"mini"},on:{click:function(n){return e.handleAcceptExample(t.$index)}}},[e._v(" Accept ")]),n("el-button",{attrs:{round:"",type:"warning",size:"mini"},on:{click:function(n){return e.handleRejectExample(t.$index)}}},[e._v(" Reject ")]),n("el-button",{attrs:{round:"",type:"danger",size:"mini"},on:{click:function(n){return e.handleDelExample(t.$index)}}},[e._v(" Delete ")])],1)]}}])})],1)],1),n("div",{staticClass:"ef-annotation-footer"},[n("el-row",[n("el-col",{attrs:{span:6}},[n("div",{staticClass:"ef-footer-ops",staticStyle:{display:"inline-block",padding:"0px 0xp 0px 10px"}},[e._v("\n                         \n                    "),n("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.handleDelUnSelectExample}},[e._v("反向选择")]),n("el-button",{attrs:{type:"warning",size:"mini",round:""},on:{click:e.handleDelSelectExample}},[e._v("删除选中样本")])],1)]),n("el-col",{attrs:{span:18}},[n("div",{staticClass:"ef-footer-pagins",staticStyle:{display:"inline-block","text-align":"right",width:"100%",padding:"0px 10px 0px 0px !important"}},[n("el-pagination",{staticStyle:{display:"inline-block"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,40,80,160,320],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalnum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)],1)])},a=[],l=(n("ac6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ef-slide-container"},[n("span",[e._v("Query: ")]),n("div",{staticStyle:{margin:"0px 0px 10px 0px",overflow:"scroll",padding:"10px 2px 10px 2px"}},[n("div",{staticClass:"ef-slide-mask",staticStyle:{"write-space":"nowrap",display:"inline-block",height:"30px",padding:"0px 0px 0px 20px"}},[n("span",{staticClass:"ef-slide-query",on:{click:function(t){return e.handleSlideFrame(t)}}},[e._v(e._s(e.query))])]),n("div",{staticClass:"ef-slide-show",staticStyle:{"write-space":"nowrap",display:"inline-block",height:"30px",padding:"0px 0px 0px 20px"}},[n("span",{ref:"showContent"},[e._v(e._s(e.showContent))])])]),n("div",{staticClass:"el-slide-infos",staticStyle:{width:"100%"}},[n("el-table",{attrs:{stripe:"","highlight-current-row":"",data:e.frames,"show-header":!1,"max-height":"130px","row-style":{height:"35px"},"cell-style":{padding:"0px"}}},[n("el-table-column",{attrs:{label:"",prop:"entity",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:t.row.entity,callback:function(n){e.$set(t.row,"entity",n)},expression:"scope.row.entity"}})]}}])}),n("el-table-column",{attrs:{label:"",prop:"value",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:t.row.value,callback:function(n){e.$set(t.row,"value",n)},expression:"scope.row.value"}}),e._v("\n                       \n                    "+e._s(t.row.value)+"\n                ")]}}])}),n("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelSlide(t.$index,t.row)}}})]}}])})],1),n("div",{staticStyle:{"text-align":"left",width:"100%",margin:"4px 2px 0px 2px"}},[n("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:function(t){return e.handleAddSlide()}}},[e._v("添加实体: "+e._s(e.cur_slide.value)+" ")])],1)],1)])}),s=[],o=(n("6b54"),{name:"word-slider",props:{query:{type:String,default:""},frames:{type:Array,default:function(){return[]}},slotnames:{type:Array,default:function(){return[]}}},data:function(){return{showContent:void 0,show_detail:!1,cur_slide:{entity:"",value:"",start:-1,end:-1}}},mounted:function(){console.log("当前传入的query为: ",this.query),this.showContent=this.query+"",this.heighLight()},created:function(){},methods:{handleSlideFrame:function(e){if(document.body.createTextRange)document.body.createTextRange();else{var t=window.getSelection(),n=t.toString(),i=t.anchorOffset,a=t.focusOffset;i<a&&(this.cur_slide.value=n,this.cur_slide.start=i,this.cur_slide.end=a)}this.clearSelection()},clearSelection:function(){"getSelection"in window?window.getSelection().removeAllRanges():document.selection.empty()},heighLight:function(){var e=this.query,t=[],n=e.length+2*this.frames.length,i=0,a=0;console.log("当前划词内容: ",this.frames);for(var l=0;l<this.frames.length;l++){for(var s=this.frames[l],o=(s["value"],s["start"]),c=s["end"],r=i;r<o+a;r++)t[r]=this.query[r-a];t[o+a]='<span style="color:lightblue;">',a+=1;for(r=o+a;r<c+a;r++)t[r]=this.query[r-a];t[c+a]="</span>",a+=1,i=c+a}console.log("剩余部分的内容为: ",i,n);for(l=i;l<n;l++)t[l]=this.query[l-a];this.$refs.showContent.innerHTML=t.join("")},handleDelSlide:function(e,t){this.frames.splice(e,1),this.heighLight()},handleAddSlide:function(){if(void 0!==this.cur_slide){var e={entity:this.cur_slide.entity,value:this.cur_slide.value,start:this.cur_slide.start,end:this.cur_slide.end};this.frames.push(e),this.heighLight()}}}}),c=o,r=(n("9cb0"),n("2877")),u=Object(r["a"])(c,l,s,!1,null,null,null),d=u.exports,p={name:"annotation",components:{Slider:d},data:function(){return{currentPage:1,pageSize:20,multipleSelection:[],example:{text:"i'm looking for a place in the north of town",intent:"restaurant_search",entities:[{start:31,end:36,value:"north",entity:"location"}]},tableData:[{id:"1",intent:"好滋好味鸡蛋仔1",text:"荷兰优质淡奶，奶香浓而不腻1",entities:[{entity:"contry",value:"荷兰",start:0,end:2}],check:1}]}},mounted:function(){},created:function(){},computed:{tableHeight:function(){return window.innerHeight-127},AfterChanageData:function(){var e=(this.currentPage-1)*this.pageSize,t=this.currentPage*this.pageSize;return this.tableData.slice(e,t)},totalnum:function(){return this.tableData.length}},methods:{toogleExpand:function(e){var t=this.$refs.table;t.toggleRowExpansion(e)},download:function(){var e=this.multipleSelection;e=JSON.stringify({rasa_nlu_data:{common_examples:this.multipleSelection}});var t="data:text/json;charset=utf-8,\ufeff"+encodeURIComponent(e),n=document.createElement("a");n.href=t,n.download="annoted_examples.json",document.body.appendChild(n),n.click(),document.body.removeChild(n)},parse_upload:function(e){var t=e.data.content.rasa_nlu_data.common_examples,n=t.map(function(e,t){return e.id=void 0===e.id?t+1:e.id,e.check=void 0===e.check?0:e.check,e});return console.log("解析后: ",n),n},beforeTrainFileUpload:function(e){var t=this,n=new FormData;return n.append("filename",e),this.$http.post("http://127.0.0.1:5000/api/uploadTrainfile",n).then(function(e){console.log("训练文件上传成功"),console.log(e),t.tableData=t.parse_upload(e),console.log("加载到的parse 数据为: ",t.tableData)},function(e){console.log("训练文件上传失败"),console.log(e)}),!1},fileuploadsucess:function(){this.$message({message:"文件上传成功!",type:"success"})},fileuploadfail:function(){this.$message({message:"文件上传失败!",type:"warning"})},handleDelSlide:function(e,t,n){var i=this;console.log("触发删除槽位操作: ",e," ",t," ",n),this.$confirm("确认是否删除当前槽位?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.tableData[e].entities.splice(t,1),i.$message({type:"success",message:"槽位删除成功!"})}).catch(function(){i.$message({type:"info",message:"槽位删除失败!"})})},handleAddSlide:function(e,t){console.log("触发添加槽位操作: ",e," ",t);var n={entity:"",value:"",start:-1,end:-1};this.tableData[e].entities.push(n)},handleAddExample:function(){var e=this;console.log("触发添加样本操作: ");var t={id:this.tableData.length,intent:"",text:"",entities:[],check:0};this.tableData.push(t),console.log("refs 内容: ",this.$refs);var n=this.$refs.table;this.$nextTick(function(){n.bodyWrapper.scrollTop=e.$refs.table.bodyWrapper.scrollHeight})},handleDelExample:function(e){var t=this;console.log("触发删除样本操作: ",e),this.$confirm("确认是否删除当前样本?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.tableData.splice(e,1),t.$message({type:"success",message:"当前样本删除成功!"})}).catch(function(){t.$message({type:"info",message:"当前样本删除失败!"})})},handleAcceptExample:function(e){this.tableData[e].check=1,this.$message({type:"success",message:"判断当前样本标注正确!"})},handleRejectExample:function(e){this.tableData[e].check=-1,this.$message({type:"warning",message:"判断当前样本标注错误!"})},handleIgnoreExample:function(e){this.tableData[e].check=0,this.$message({type:"info",message:"忽略当前样本标注结果!"})},handleSelectionChange:function(e){console.log("table 多选结果: ",e),this.multipleSelection=e},handleDelUnSelectExample:function(){var e=this;console.log("触发删除未选中样本");var t=this.multipleSelection.length,n=(this.tableData.length,this.tableData.filter(function(n){for(var i=!1,a=0;a<t;a++)n.id===e.multipleSelection[a].id&&(i=!0);return i}));n.forEach(function(t){e.$refs.table.toggleRowSelection(t)}),this.multipleSelection.length>0?this.multipleSelection.forEach(function(t){e.$refs.table.toggleRowSelection(t)}):this.$refs.table.clearSelection()},handleDelSelectExample:function(){var e=this;console.log("触发删除选中样本");var t=this.multipleSelection.length;this.$confirm("确认是否删除当前选中的"+t+"条样本?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.tableData=e.tableData.filter(function(n){for(var i=!0,a=0;a<t;a++)n.id===e.multipleSelection[a].id&&(i=!1);return i}),e.$message({type:"success",message:"成功删除"+t+"条样本!"})}).catch(function(){e.$message({type:"info",message:"取消删除!"})})},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e}}},h=p,f=(n("c19f"),Object(r["a"])(h,i,a,!1,null,null,null));t["default"]=f.exports}}]);