(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ad14bda"],{"34a1":function(e,t,a){},"817a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nlg-template-container"},[e._m(0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDomain,expression:"showDomain"}],staticClass:"ef-menu-container"},[a("div",{staticClass:"ef-menu-header"},[e._m(1),a("el-button",{staticStyle:{color:"black","font-size":"15px",display:"inline-block",float:"right",padding:"8px 5px 5px 0px"},attrs:{type:"text",icon:"el-icon-s-fold"},on:{click:e.closeDomainSide}})],1),a("domain-editor",{attrs:{treeheight:450,data:e.domainData,cateType:"show"},on:{cateSelected:e.handleCateSelected,openCateEdit:e.handleCateEdit}})],1),a("div",{ref:"showContainer",class:[e.showDomain?"ef-show-container":"ef-show-container-max"]},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.showDomain,expression:"!showDomain"}]},[a("el-button",{staticStyle:{color:"black","font-size":"15px",display:"inline-block",float:"left",padding:"8px 5px 5px 0px"},attrs:{type:"text",icon:"el-icon-s-unfold"},on:{click:e.openDomainSide}})],1),a("div",{staticClass:"sp-filter-container"}),a("div",{staticClass:"sp-show-container"},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.showData,height:e.tableHeight,"header-cell-style":{background:"#F5F7F8"}}},[a("el-table-column",{attrs:{label:"脚本ID",prop:"id"}}),a("el-table-column",{attrs:{label:"脚本标题",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"修改人",prop:"editor"}}),a("el-table-column",{attrs:{label:"编辑时间",prop:"editTime"}}),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("div",[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleTemplateCreate()}}},[e._v("新建")])],1)]}},{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleTemplateEdit(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleTemplateDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])})],1)],1),a("div",{staticClass:"sp-pg-container"},[a("el-pagination",{attrs:{"current-page":e.curPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,modal:!1,size:"50%","with-header":!0,"before-close":e.handleTemplateEditorClose},on:{"update:visible":function(t){e.drawer=t}}},[a("templateEditor",{attrs:{templateData:e.curTemplate},on:{confirm:e.handleConfirmEditEvent,cancel:e.handleCancelEditEvent}})],1)],1),a("el-dialog",{attrs:{title:"场景编辑",visible:e.showSecneDialog},on:{"update:visible":function(t){e.showSecneDialog=t}}},[a("span",[e._v(" 场景编辑占位符 ")]),a("domain-editor",{attrs:{treeheight:450,data:e.domainData,cateType:"edit"},on:{openCateEdit:e.handleCateEdit}})],1)],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ef-nlg-header"},[a("div",{staticStyle:{padding:"10px"}},[a("span",{staticStyle:{"font-size":"15px"}},[e._v("  NLG执行脚本编辑  ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("b",[e._v("场景")])])}],o=(a("456d"),a("c5f6"),a("ac6a"),a("20d6"),a("0789")),s=a("cf45"),l=a("22c0"),r=a("0960"),c={name:"NLGEidtor",components:{domainEditor:l["a"],templateEditor:r["a"]},computed:{showData:function(){return this.templateData}},data:function(){return{showDomain:!1,domainData:[],templateData:[],showSecneDialog:!1,direction:"rtl",drawer:!1,tableHeight:window.innerHeight-210,curTemplate:void 0,curPage:1,pageSize:10,totalNum:-1}},methods:{closeDomainSide:function(){console.log("触发关闭domain 侧边栏!"),this.showDomain=!1},openDomainSide:function(){console.log("打开 domain 侧边栏"),this.showDomain=!0},cancelForm:function(){this.showDomain=!1},handleSizeChange:function(e){var t=this;this.curPage=1,this.pageSize=e;var a={page:this.curPage,per_page:this.pageSize,endpoint:""};Object(o["f"])(a).then(function(e){t.templateData=e["items"],t.totalNum=e["_meta"]["total_items"]})},handleCurrentChange:function(e){var t=this;this.curPage=e;var a={page:this.curPage,per_page:this.pageSize,endpoint:""};Object(o["f"])(a).then(function(e){t.templateData=e["items"],t.totalNum=e["_meta"]["total_items"]})},handleCateSelected:function(){console.log("触发domain 选中事件")},handleCateEdit:function(){console.log("触发domain编辑事件"),this.showSecneDialog=!0},handleTemplateEdit:function(e,t){console.log("当前编辑的 脚本index为: ",e),this.drawer=!0,this.curTemplate=this.templateData[e],this.process_template(this.curTemplate)},handleTemplateDelete:function(e,t){this.templateData.splice(e,1),Object(o["d"])(t).then(function(e){console.log("删除成功")})},handleTemplateCreate:function(){this.drawer=!0;this.userName,Object(s["b"])(),this.userName,Object(s["b"])();var e={id:void 0,name:"",creator:this.userName,createTime:Object(s["b"])(),editor:this.userName,editdate:Object(s["b"])(),describe:{domain:"",sub_domain:"",intent:"",slots:[],version:"",intent_type:"",loop_main_key:""},templates:[],keywords:[],fmt:{},rely_intent:{type:"op",value:"",child:[]},checker:{}};this.curTemplate=e},handleTemplateEditorClose:function(){this.drawer=!1,this.curTemplate=void 0},handleConfirmEditEvent:function(e){this.drawer=!1,console.log("接收到修改后的数据为: ",e);var t=this.findeIdx(e);if(-1===t){var a=Object(s["d"])(10,16);console.log("新建的 脚本的id为: ",a),console.log("当前脚本的修改人为: ",this.userName),e.id=a,e.name=e.describe.domain+"-"+e.describe.sub_domain+"-"+e.describe.intent+"-"+e.describe.version,e.creator=this.userName,e.createTime=Object(s["b"])(),e.editor=this.userName,e.editTime=Object(s["b"])(),this.templateData.unshift(e),this.postProcess_template(e),console.log("保存的数据格式为: ",JSON.stringify(e)),Object(o["b"])(_.cloneDeep(e)).then(function(e){console.log("新建script 数据保存成功",e)})}else this.templateData[t].name=e.describe.domain+"-"+e.describe.sub_domain+"-"+e.describe.intent+"-"+e.describe.version,this.templateData[t].editor=this.userName,this.templateData[t].editTime=Object(s["b"])(),this.templateData[t].describe=_.cloneDeep(e.describe),this.templateData[t].templates=_.cloneDeep(e.templates),this.templateData[t].keywords=_.cloneDeep(e.keywords),this.templateData[t].fmt=_.cloneDeep(e.fmt),this.templateData[t].rely_intent=_.cloneDeep(e.rely_intent),this.templateData[t].checker=_.cloneDeep(e.checker),this.postProcess_template(this.templateData[t]),console.log("保存的数据格式为: ",JSON.stringify(this.templateData[t])),Object(o["h"])(_.cloneDeep(this.templateData[t])).then(function(e){console.log("修改同步后台成功!",e)})},handleCancelEditEvent:function(e){this.drawer=!1,this.curScript=void 0},findeIdx:function(e){var t=e.id,a=this.templateData.findIndex(function(e){return e.id===t});return-1!==a&&this.templateData[a].version!==e.version&&(a=-1),a},trans_to_arr:function(e){if("op"===e.type&&"OR"!==e.value&&"AND"!==e.value){console.log("当前的触发条件为: ",JSON.stringify(e));var t={type:"op",value:"AND",child:[_.cloneDeep(e)]};e=t}return e},process_template:function(e){var t=this;e.templates.forEach(function(e){e.trigger=t.trans_to_arr(e.trigger)}),void 0===e.rely_intent.child&&(e.rely_intent={type:"op",value:"",child:[]})},extract_singleCondition:function(e){return("op"===e.type&&"OR"===e.value||"op"===e.type&&"AND"===e.value)&&1===e.child.length?e.child[0]:e},postProcess_template:function(e){var t=this;e.templates.forEach(function(e){e.trigger=t.extract_singleCondition(e.trigger),e.group_id=Number(e.group_id)}),0===e.rely_intent.child.length&&(e.rely_intent={})},fmtPostProcess:function(e){},checkerPostProcess:function(e){},param_to_arr:function(e){var t=[],a=Object.keys(e);for(var i in a){var n=a[i],o=e[n],s={key:n,val:o};t.push(s)}return t},arr_to_param:function(e){var t={};for(var a in e){var i=e[a],n=i["key"],o=i["val"];t[n]=o}return t}},mounted:function(){var e=this;console.log("展示容器的高度为: ",this.$refs.showContainer.clientHeight),console.log("表格高度为: ",window.innerHeight-210),this.userName=localStorage.getItem("userName"),console.log("当前的用户名为: ",this.userName);var t={page:this.curPage,per_page:this.pageSize,endpoint:""};Object(o["f"])(t).then(function(t){e.templateData=t["items"],e.totalNum=t["_meta"]["total_items"],console.log("加载的记录总数为: ",e.totalNum)})}},d=c,p=(a("c30d"),a("2877")),h=Object(p["a"])(d,i,n,!1,null,"c0be4228",null);t["default"]=h.exports},c30d:function(e,t,a){"use strict";var i=a("34a1"),n=a.n(i);n.a}}]);