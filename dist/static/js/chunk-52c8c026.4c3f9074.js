(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52c8c026","chunk-5392adf8"],{"03a2":function(t,e,n){"use strict";var i=n("92ba"),s=n.n(i);s.a},"07de":function(t,e,n){"use strict";var i=n("64aa"),s=n.n(i);s.a},"081e":function(t,e,n){"use strict";var i=n("d5ff"),s=n.n(i);s.a},"096f":function(t,e,n){"use strict";var i=n("f838"),s=n.n(i);s.a},"0faf":function(t,e,n){},"1c89":function(t,e,n){},"1ca5":function(t,e,n){"use strict";var i=n("f3a7"),s=n.n(i);s.a},"2a82":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"},on:{click:t.addIntentInfo}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2),t._m(1),n("div",{staticClass:"ef-condition ef-sub-section"},[n("condition-panel",{attrs:{userId:t.userId,botId:t.botId,has_transition:!1,transitions:t.trigger}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.queryExamples.length>0,expression:"queryExamples.length > 0"}],staticClass:"ef-query-lst"},t._l(t.queryExamples,function(e,i){return n("div",{key:i,staticClass:"ef-query-elem"},[n("div",{staticClass:"ef-intent ef-sub-section",staticStyle:{position:"relative"}},[t._v("\n                          \n                        "),n("span",[t._v("* 选择意图: ")]),t._v("\n                          \n                        "),n("el-select",{attrs:{filterable:"","allow-create":"",size:"small",placeholder:"请选择"},on:{focus:function(e){return t.activeExampleIntent(i)},change:t.changeExampleIntent},model:{value:e.selectedIntent,callback:function(n){t.$set(e,"selectedIntent",n)},expression:"queryExample.selectedIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentId}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"},on:{click:t.addIntentInfo}})],2),n("div",{staticStyle:{position:"absolute",top:"-5px",right:"4px"}},[n("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.delQueryExample(i)}}})])],1),n("div",{staticClass:"ef-query ef-sub-section"},[t._v("\n                          \n                        "),n("span",[t._v("* 选择例句:")]),t._v("\n                          \n                        "),n("el-select",{attrs:{id:"ef-query-select",filterable:"","allow-create":"",size:"small",placeholder:"请选择"},on:{focus:function(e){return t.activeExampleQuery(i)},change:t.changeExampleQuery},model:{value:e.selectedQuery,callback:function(n){t.$set(e,"selectedQuery",n)},expression:"queryExample.selectedQuery"}},[t._l(t.intentInfos[i].queryLst,function(t,e){return n("el-option",{key:e,attrs:{label:t.query,value:e}})}),n("el-option",{attrs:{label:"创建例句",value:"newQuery"},on:{click:function(n){return t.editIntentInfo(e.selectedIntent)}}})],2)],1)])}),0),n("div",[n("i",{staticClass:"el-icon-circle-plus-outline",on:{click:t.addQueryExample}},[t._v(" 添加用户意图")])]),t._m(3),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curSlotList,"max-height":"200",border:"",size:"small"}},[n("el-table-column",{attrs:{prop:"isRequie",label:"必填",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isRequie,callback:function(n){t.$set(e.row,"isRequie",n)},expression:"scope.row.isRequie"}})]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"槽名",width:"80"}}),n("el-table-column",{attrs:{prop:"entityName",label:"实体名",width:"100"}}),n("el-table-column",{attrs:{prop:"isArray",label:"数组",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isArray,callback:function(n){t.$set(e.row,"isArray",n)},expression:"scope.row.isArray"}})]}}])}),n("el-table-column",{attrs:{prop:"reAsk",label:"话术"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.addUtts("inform",e.$index)}}})]}}])})],1)],1),t._m(4),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curReqSlotList,"max-height":"200",border:"",size:"small"}},[n("el-table-column",{attrs:{prop:"slotName",label:"槽名",width:"80"}}),n("el-table-column",{attrs:{prop:"entityName",label:"实体名",width:"100"}}),n("el-table-column",{attrs:{prop:"isArray",label:"数组",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isArray,callback:function(n){t.$set(e.row,"isArray",n)},expression:"scope.row.isArray"}})]}}])}),n("el-table-column",{attrs:{prop:"reAsk",label:"话术"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.addUtts("request",e.$index)}}})]}}])})],1)],1),t._m(5),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curActionList,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.curSlotList,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.deleteAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addAction}},[t._v("添加对话动作")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[t._m(6),n("div",{staticClass:"ef-confirm-lst"},[t._l(t.confirmConfig,function(e,i){return n("div",{key:i,staticStyle:{border:"2px solid lightgrey","border-radius":"10px",margin:"5px 10px",padding:"5px 0px"}},[n("div",{staticStyle:{"text-align":"right","padding-right":"5px"}},[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.deleteConfirmItem(i)}}})],1),n("el-form",{ref:"form",refInFor:!0,attrs:{model:e,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"最大确认次数: "}},[n("el-input",{staticStyle:{width:"200px"},model:{value:e.maxConfirmNo,callback:function(n){t.$set(e,"maxConfirmNo",n)},expression:"confirm.maxConfirmNo"}})],1),n("el-form-item",{attrs:{label:"机器人动作名: "}},[n("el-input",{staticStyle:{width:"200px"},model:{value:e.nlgActName,callback:function(n){t.$set(e,"nlgActName",n)},expression:"confirm.nlgActName"}})],1),n("el-form-item",{attrs:{label:"确认话术: "}},[n("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea"},model:{value:e.nlgTemplate,callback:function(n){t.$set(e,"nlgTemplate",n)},expression:"confirm.nlgTemplate"}})],1),n("el-form-item",{attrs:{label:"确认槽位列表"}},[t._l(e.slots,function(e){return n("el-tag",{key:e.slotId,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleConfirmSlotClose(i,e.slotId)}}},[t._v("\n                                "+t._s(e.slotName)+"\n                            ")])}),t.inputConfirmSlot?n("el-select",{ref:"confirmInput",refInFor:!0,staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:function(e){return t.handleConfirmSlotInputConfirm(i)}},model:{value:t.confirmSlotName,callback:function(e){t.confirmSlotName=e},expression:"confirmSlotName"}},t._l(t.curSlotList,function(t){return n("el-option",{key:t.slotId,attrs:{label:t.slotName,value:t.slotName}})}),1):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.showConfirmSlotInput(i)}}},[t._v("+ 确认槽位")])],2)],1)],1)}),n("div",{staticStyle:{"text-align":"left","padding-left":"20px","margin-top":"10px"}},[n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.addConfirmItem}}),t._v(" 添加确认话术\n                ")],1)],2),t._m(7),n("after-set",{attrs:{userId:t.userId,botId:t.botId,operations:t.afterSettings}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"定义话术",visible:t.showUttEdit,modal:!1,width:"80%"},on:{"update:visible":function(e){t.showUttEdit=e}}},[n("div",{staticStyle:{height:"420px",overflow:"scroll"}},[n("el-form",[n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Inform 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.info_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Request 话术: ")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.req_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'request'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("request",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'request'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("request",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("request",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("request")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Confirm 话术: ")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.confirm_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'confirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("confirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'confirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("confirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("confirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("confirm")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Disconfirm 话术: ")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.disconfirm,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'disconfirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("disconfirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'disconfirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("disconfirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("disconfirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("disconfirm")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Inform Add 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.inform_add,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform_add'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform_add",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'inform_add'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform_add",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform_add",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform_add")}}},[t._v("+ 增加话术")])],1)])])],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelAddUtts}},[t._v("取 消")]),n("el-button",{on:{click:t.confirmAddUtts}},[t._v("确 定")])],1)]),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("触发条件")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("问句设置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("约束槽位配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("请求槽位配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("动作配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("确认配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v(" 执行后动作")])])])}],o=(n("6b54"),n("a481"),n("7514"),n("20d6"),n("2ef0")),a=n("3095"),l=n("6a3b"),r=n("8123"),c={name:"user-form",components:{conditionPanel:a["a"],intentInfo:l["a"],afterSet:r["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:Object(o["cloneDeep"])(this.nodeInfo),showUttEdit:!1,curSlotType:"",curSlotIndex:-1,curUttType:"",curUttIndex:-1,tab_index:1,actionOptions:["inform","deform","confirm","request","negate","yn","deny","dontcare","reqmore","repeat","change"],expIntentShow:!1,expIntent:"",expectIntents:[],intentList:[],selectedIntent:"",intentInfo:{},selectedQuery:"",queryExamples:[{selectedIntent:"",selectedQuery:""}],curQueryExample:{},intentInfos:[{}],exampleIndex:-1,curQueryInfo:{},curSlotList:[],curReqSlotList:[],curActionList:[],curUtts:[],slotType:"",slotIndex:-1,confirmConfig:[{slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""}],inputConfirmSlot:!1,confirmSlotName:"",trigger:[],curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1,afterSettings:[]}},methods:{handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},delQueryExample:function(t){this.queryExamples.splice(t,1),this.intentInfos.splice(t,1)},addQueryExample:function(){this.queryExamples.push({selectedIntent:"",selectedQuery:""}),this.intentInfos.push({})},activeExampleIntent:function(t){console.log("激活例句 ",t,"所在Intent模块"),this.exampleIndex=t,this.curQueryExample=this.queryExamples[t],this.selectedIntent=this.curQueryExample.selectedIntent},activeExampleQuery:function(t){console.log("激活例句 ",t,"所在Query模块"),this.exampleIndex=t,this.curQueryExample=this.queryExamples[t],this.selectedIntent=this.curQueryExample.selectedIntent,this.selectedQuery=this.curQueryExample.selectedQuery},changeExampleIntent:function(t){this.selectedIntent=t,console.log("当前selected Intent: ",this.selectedIntent)},changeExampleQuery:function(t){this.selectedQuery=t,console.log("当前selected Query: ",this.selectedQuery)},handleConfirmSlotClose:function(t,e){this.confirmConfig[t].slots.splice(this.confirmConfig[t].slots.findIndex(function(t){return t.slotId===e}),1)},showConfirmSlotInput:function(t){this.inputConfirmSlot=!0,this.$nextTick(function(t){})},handleConfirmSlotInputConfirm:function(t){var e=this.confirmSlotName;if(e){var n=this.curSlotList.find(function(t){return t.slotName===e});this.confirmConfig[t].slots.push({slotName:n.slotName,slotId:n.slotId})}this.inputConfirmSlot=!1,this.confirmSlotName=""},addConfirmItem:function(){this.confirmConfig.push({slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""})},deleteConfirmItem:function(t){this.confirmConfig.splice(t,1)},nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.trigger=t.nodeContent.trigger,this.expectIntents=t.nodeContent.expectIntents,this.selectedIntent=t.nodeContent.selectedIntent,this.selectedQuery=t.nodeContent.selectedQuery,this.curSlotList=t.nodeContent.infoSlotList,console.log("userForm表单接收的curslotlist: ",t,this.curSlotList),this.curReqSlotList=t.nodeContent.reqSlotList,this.curActionList=t.nodeContent.actionList,this.confirmConfig=t.nodeContent.confirmConfig,this.queryExamples=t.nodeContent.queryExamples,this.intentInfos=t.nodeContent.intentInfos,this.afterSettings=void 0!==t.nodeContent.afterSettings?t.nodeContent.afterSettings:[]},loadIntentInfoList:function(t,e){return this.$store.state.nlu.intentInfoList},choiceIntent:function(t){return this.intentList.find(function(e){return e.intentId===t})},extract_queryInfo:function(t,e){var n=this;console.log("watch函数为初始化槽位");var i=this.intentInfos[t].queryLst[e];return{query:i.query,slotInfo:i.slidewords.map(function(t){console.log("watch 加载的 inform 槽位: ",n.curSlotList);var e=n.curSlotList.findIndex(function(e){return e.slotName===t.slotName});return{slotName:t.slotName,entityName:t.slotSource,tagVal:t.tagVal,startPos:t.start,endPost:t.end,isRequie:!0,isArray:!1,utts:{info_utts:-1===e?[]:n.curSlotList[e].utts.info_utts,req_utts:-1===e?[]:n.curSlotList[e].utts.req_utts,confirm_utts:-1===e?[]:n.curSlotList[e].utts.confirm_utts,disconfirm:-1===e?[]:n.curSlotList[e].utts.disconfirm,inform_add:-1===e?[]:n.curSlotList[e].utts.inform_add}}}),reqSlotInfo:i.reqSlots.map(function(t){var e=n.curReqSlotList.findIndex(function(e){return e.slotName===t.slotName});return{slotName:t.slotName,entityName:t.slotSource,isArray:!1,utts:{info_utts:-1===e?[]:n.curReqSlotList[e].utts.info_utts,req_utts:-1===e?[]:n.curReqSlotList[e].utts.req_utts,confirm_utts:-1===e?[]:n.curReqSlotList[e].utts.confirm_utts,disconfirm:-1===e?[]:n.curReqSlotList[e].utts.disconfirm,inform_add:-1===e?[]:n.curReqSlotList[e].utts.inform_add}}}),actionInfo:[]}},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,trigger:this.trigger,expectIntents:this.expectIntents,selectedIntent:this.selectedIntent,selectedQuery:this.selectedQuery,infoSlotList:this.curSlotList,reqSlotList:this.curReqSlotList,actionList:this.curActionList,confirmConfig:this.confirmConfig,queryExamples:this.queryExamples,intentInfos:this.intentInfos,afterSettings:this.afterSettings},this.$emit("event:update",this.node)},createInentHandle:function(){console.log("触发创建新意图事件"),this.$emit("event:createIntent")},createQueryHandle:function(){console.log("触发创建新的例句事件"),this.$emit("event:createQuery")},addUtts:function(t,e){console.log(t+" 为槽位: "+e+"添加话术"),this.slotType=t,this.slotIndex=e,"inform"===t?(this.curUtts=this.curSlotList[e].utts,console.log("为槽位",e,"添加话术:",this.curUtts,this.curSlotList[e].utts)):"request"===t&&(this.curUtts=this.curReqSlotList[e].utts),console.log("当前话术为: ",this.curUtts),this.showUttEdit=!0},addUttItem:function(t){"inform"===t?this.curUtts.info_utts.push({utt:""}):"request"===t?this.curUtts.req_utts.push({utt:""}):"confirm"===t?this.curUtts.confirm_utts.push({utt:""}):"disconfirm"===t?this.curUtts.disconfirm.push({utt:""}):"inform_add"===t&&this.curUtts.inform_add.push({utt:""}),console.log("添加一条话术"),this.$message({type:"success",message:"增加一条"+t+"话术"})},deleteUttItem:function(t,e){var n=this,i=this;i.$confirm("将要删除当前"+t+"话术, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"inform"===t?n.curUtts.info_utts.splice(e,1):"request"===t?n.curUtts.req_utts.splice(e,1):"confirm"===t?n.curUtts.confirm_utts.splice(e,1):"disconfirm"===t?n.curUtts.disconfirm.splice(e,1):"inform_add"===t&&n.curUtts.inform_add.splice(e,1),i.$message({type:"success",message:"当前"+t+"话术成功删除"})}).catch(function(){i.$message({type:"info",message:"已取消话术删除"})})},editUttItem:function(t,e){console.log("触发编辑话术"),this.curUttType=t,this.curUttIndex=e,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},saveUttItem:function(t,e){console.log("触发保存话术"),this.curUttType="",this.curUttIndex=-1,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},addAction:function(){console.log("触发添加动作的操作"),this.curActionList.push({action:"",slotOp:"",slotName:""})},cancelAddUtts:function(){this.showUttEdit=!1},confirmAddUtts:function(){console.log(this.slotType+" 为槽位: "+this.slotIndex+"添加话术"),"inform"===this.slotType?(this.curSlotList[this.slotIndex].utts=Object(o["cloneDeep"])(this.curUtts),console.log(this.slotType+" 为槽位: "+this.slotIndex+"添加话术",this.curSlotList[this.slotIndex].utts)):"request"===this.slotType&&(this.curReqSlotList[this.slotIndex].utts=Object(o["cloneDeep"])(this.curUtts),console.log(this.slotType+" 为槽位: "+this.slotIndex+"添加话术",this.curReqSlotList[this.slotIndex].utts)),this.slotType="",this.slotIndex=-1,this.showUttEdit=!1},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}}},watch:{selectedIntent:function(t){console.log("触发选中意图变化",t),console.log("选中的意图: ",t),""!==t&&("newIntent"===t?this.addIntentInfo():(this.intentInfos[this.exampleIndex]=this.choiceIntent(t),console.log("当前的意图: ",this.intentInfos[this.exampleIndex])))},selectedQuery:function(t){if(""!==t&&void 0!==t)if("newQuery"===t)this.editIntentInfo(this.selectedIntent);else{for(var e=[],n=[],i=[],s={},o={},a=0;a<this.queryExamples.length;a++){var l=this.extract_queryInfo(a,this.queryExamples[a].selectedQuery);i.push({action:"intent",slotOp:"=",slotName:this.intentInfos[a].intentName});for(var r=0;r<l.slotInfo.length;r++){var c=l.slotInfo[r];console.log("inform slot: ",c),s[c.slotName]||(e.push(c),s[c.slotName]=c)}for(var d=0;d<l.reqSlotInfo.length;d++){var u=l.reqSlotInfo[d];console.log("req slot: ",u),o[u.slotName]||(n.push(u),o[u.slotName]=u)}}this.curSlotList=e,this.curReqSlotList=n;var p=this.curSlotList.map(function(t){return{action:"inform",slotOp:"=",slotName:t.slotName}}),f=this.curReqSlotList.map(function(t){return{action:"request",slotOp:"=",slotName:t.slotName}});this.curActionList=i,this.curActionList=this.curActionList.concat(p),console.log("inform action",p),this.curActionList=this.curActionList.concat(f),console.log("request action",f),console.log("当前的动作信息为: "),console.log(this.curActionList)}}},mounted:function(){this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId)}},d=c,u=(n("d787"),n("2877")),p=Object(u["a"])(d,i,s,!1,null,null,null);e["a"]=p.exports},"2e15":function(t,e,n){"use strict";var i=n("625c"),s=n.n(i);s.a},3095:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-cond-container"},[t._l(t.transitions,function(e,i){return n("div",{key:i,staticClass:"ef-cond-group"},[n("div",{staticClass:"ef-group-del"},[n("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.delGroupHandle(i)}}})]),t._l(e.conditionGroup,function(e,s){return n("div",{key:s,staticClass:"ef_or_group"},[t._l(e.conditions,function(e,o){return n("div",{key:o,staticClass:"ef-and-cond"},[n("div",{staticClass:"ef-cond",on:{click:function(e){return t.condFocusHandle(i,s,o)}}},[n("div",{staticClass:"ef-cond-elem"},[n("el-select",{staticStyle:{width:"98px"},attrs:{size:"mini",placeholder:"变量类型"},on:{focus:function(e){return t.condFocusHandle(i,s,o)}},model:{value:e.property.propertyType,callback:function(n){t.$set(e.property,"propertyType",n)},expression:"candition.property.propertyType"}},t._l(t.candTypeList,function(t){return n("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})}),1)],1),n("div",{staticClass:"ef-cond-elem"},["intent"!==e.property.propertyType&&"true"!==e.property.propertyType?n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"180px"},attrs:{size:"mini","trigger-on-focus":!0,"fetch-suggestions":function(n,i){t.queryVarSearchAsync(n,i,e.property.propertyType)},placeholder:"请输入内容"},on:{focus:function(e){return t.condFocusHandle(i,s,o)},select:function(n){return t.handleTransCondVarSelect(n,e.property.propertyType,e)}},model:{value:e.property.propertyFullName,callback:function(n){t.$set(e.property,"propertyFullName",n)},expression:"candition.property.propertyFullName"}}):t._e()],1),n("div",{staticClass:"ef-cond-elem"},["true"!==e.property.propertyType?n("el-select",{staticStyle:{width:"96px"},attrs:{size:"mini",placeholder:"操作符"},on:{focus:function(e){return t.condFocusHandle(i,s,o)}},model:{value:e.opType,callback:function(n){t.$set(e,"opType",n)},expression:"candition.opType"}},t._l(t.opList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1):t._e()],1),n("div",{staticClass:"ef-cond-elem"},["intent"===e.property.propertyType&&"true"!==e.property.propertyType&&"is null"!==e.opType&&"not null"!==e.opType?n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"","allow-create":"",placeholder:"选择意图"},on:{focus:function(e){return t.condFocusHandle(i,s,o)}},model:{value:e.expected,callback:function(n){t.$set(e,"expected",n)},expression:"candition.expected"}},t._l(t.intentNameList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1):t._e()],1),n("div",["intent"!==e.property.propertyType&&"true"!==e.property.propertyType&&"is null"!==e.opType&&"not null"!==e.opType?n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"400px","margin-left":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(e){return t.handleTransCondSelect(e,i,s,o)}},model:{value:e.expected,callback:function(n){t.$set(e,"expected",n)},expression:"candition.expected"}}):t._e()],1),n("div",{staticClass:"ef-cond-elem ef-cand-elem-del"},[n("i",{staticClass:"el-icon-delete ",on:{click:function(e){return t.deleteCondHandle(i,s,o)}}})])])])}),n("div",{staticClass:"el-and-add",on:{click:function(e){return t.addAndCondHandle(i,s)}}},[t._v("     + 增加AND条件")]),n("br"),n("div",{staticClass:"el-or-del",on:{click:function(e){return t.delOrCondHandle(i,s)}}},[n("i",{staticClass:"el-icon-delete"}),t._v(" 删除条件组")])],2)}),n("div",{staticClass:"el-or-add",on:{click:function(e){return t.addOrCondHandle(i)}}},[t._v("   + 增加OR条件")]),n("el-divider",{attrs:{"content-position":"left"}},[t._v("变量赋值")]),n("div",{staticClass:"ef-op-group"},[t._l(e.operations,function(e,s){return n("div",{key:s,staticClass:"ef-op-elem"},[n("el-select",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.varType,expression:"operation.varType !== undefined"}],staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:"变量类型"},model:{value:e.varType,callback:function(n){t.$set(e,"varType",n)},expression:"operation.varType"}},t._l(t.varTypeList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v("\n\n                 \n\n                "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"160px"},attrs:{size:"mini","trigger-on-focus":!0,"fetch-suggestions":function(n,i){t.queryVarSearchAsync(n,i,e.varType)},placeholder:"请输入内容"},on:{select:function(n){return t.handleTransOpVarSelect(n,e.varType,e)}},model:{value:e.varName,callback:function(n){t.$set(e,"varName",n)},expression:"operation.varName"}}),t._v("\n\n\n\n                =  \n                "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"160px","margin-left":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(e){return t.handleTransOpExpressSelect(e,i,s)}},model:{value:e.opExpression,callback:function(n){t.$set(e,"opExpression",n)},expression:"operation.opExpression"}}),n("div",{staticClass:"ef-op-del"},[n("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.delOpExpressHandle(i,s)}}})])],1)}),n("div",{staticClass:"ef-op-add",on:{click:function(e){return t.addOpExpressHandle(i)}}},[t._v("   + 增加转移赋值表达式")])],2),t.has_transition?n("div",{staticClass:"transition"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("转移目标")]),t._v("\n               "),n("span",[t._v("目标对话流:")]),t._v(" \n            "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:function(e){return t.groupFocusHandle(i)},change:t.handleDestFlowNameChange},model:{value:e.target.flowName,callback:function(n){t.$set(e.target,"flowName",n)},expression:"condition_group.target.flowName"}},t._l(t.flowInfoList,function(t){return n("el-option",{key:t.task_id,attrs:{label:t.task_name,value:t.task_name}})}),1),t._v("\n\n               "),n("span",[t._v("目标节点:")]),t._v(" \n            "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:function(e){return t.groupFocusHandle(i)}},model:{value:e.target.nodeName,callback:function(n){t.$set(e.target,"nodeName",n)},expression:"condition_group.target.nodeName"}},t._l(t.nodeInfoList,function(t){return n("el-option",{key:t.nodeId,attrs:{label:t.nodeName,value:t.nodeName}})}),1)],1):t._e()],2)}),n("div",{staticClass:"ef-group-add"},[t._v("\n           "),n("span",{on:{click:function(e){return t.addGroupHandle()}}},[t._v("+ 增加转移条件")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.has_transition,expression:"has_transition"}],staticStyle:{display:"inline-block",float:"right","padding-right":"20px"}},[n("span",[t._v("使用默认转移:  ")]),n("el-switch",{attrs:{size:"mini","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.showDefaultTrans,callback:function(e){t.showDefaultTrans=e},expression:"showDefaultTrans"}})],1)]),t.has_transition?n("div",{directives:[{name:"show",rawName:"v-show",value:t.showDefaultTrans,expression:"showDefaultTrans"}],staticClass:"ef-cond-group   ef-default-trans"},[n("div",{staticStyle:{margin:"0px 0px 10px 10px"}},[t._v(" 默认转移配置: ")]),t._v("\n           "),n("span",[t._v("目标对话流:")]),t._v(" \n            "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:function(e){return t.groupFocusHandle(-1)},change:t.handleDestFlowNameChange},model:{value:t.defaultTransition.target.flowName,callback:function(e){t.$set(t.defaultTransition.target,"flowName",e)},expression:"defaultTransition.target.flowName"}},t._l(t.flowInfoList,function(t){return n("el-option",{key:t.task_id,attrs:{label:t.task_name,value:t.task_name}})}),1),t._v("\n\n               "),n("span",[t._v("目标节点:")]),t._v(" \n            "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:function(e){return t.groupFocusHandle(-1)}},model:{value:t.defaultTransition.target.nodeName,callback:function(e){t.$set(t.defaultTransition.target,"nodeName",e)},expression:"defaultTransition.target.nodeName"}},t._l(t.nodeInfoList,function(t){return n("el-option",{key:t.nodeId,attrs:{label:t.nodeName,value:t.nodeName}})}),1),n("el-divider",{attrs:{"content-position":"left"}},[t._v("变量赋值")]),t.defaultTransition.operations.length>=0?n("div",{staticClass:"ef-op-group"},[t._l(t.defaultTransition.operations,function(e,i){return n("div",{key:i,staticClass:"ef-op-elem"},[n("el-select",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.varType,expression:"operation.varType !== undefined"}],staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:"请选择"},model:{value:e.varType,callback:function(n){t.$set(e,"varType",n)},expression:"operation.varType"}},t._l(t.varTypeList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v("\n                     \n                    "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"160px"},attrs:{size:"mini","trigger-on-focus":!0,"fetch-suggestions":function(n,i){t.queryVarSearchAsync(n,i,e.varType)},placeholder:"请输入内容"},on:{select:function(n){return t.handleTransOpVarSelect(n,e.varType,e)}},model:{value:e.varName,callback:function(n){t.$set(e,"varName",n)},expression:"operation.varName"}}),t._v("\n\n\n\n\n\n\n\n                    =  \n                    "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"180px","margin-left":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(e){return t.handleDefaultOpExpressSelect(e,i)}},model:{value:e.opExpression,callback:function(n){t.$set(e,"opExpression",n)},expression:"operation.opExpression"}}),n("div",{staticClass:"ef-op-del"},[n("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.delOpExpressHandle(-1,i)}}})])],1)}),n("div",{staticClass:"ef-op-add",on:{click:function(e){return t.addOpExpressHandle(-1)}}},[t._v("   + 增加转移赋值表达式")])],2):t._e()],1):t._e()],2)},s=[],o=(n("aef6"),n("f559"),n("7514"),n("ac6a"),n("eee3")),a={name:"condition-panel",props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},has_transition:{type:Boolean,default:!0},defaultTransition:{type:Object,default:function(){return{target:{flowName:"",nodeName:""},operations:[{varType:"",varName:"a",opExpression:"a+1",opExpression_bak:""}]}}},transitions:{type:Array,default:function(){return[{conditionGroup:[{conditions:[{expected:"退款",expected_bak:"",opterator:"Equals",property:{id:"0001",key:"退款",propertyFullName:"intent_退款",propertyType:"Intent"}}]}],operations:[{varType:"",varName:"a",opExpression:"a+1",opExpression_bak:""},{varType:"",varName:"b",opExpression:"b-1",opExpression_bak:""}],target:{flowName:"",nodeName:""}}]}}},computed:{intentList:function(){return this.loadIntentInfoList(this.userId,this.botId)},allSlotInfoLst:function(){return this.buildAllSlotConfLst()},intentNameList:function(){return this.intentList.map(function(t){return t.intentName})},varNameList:function(){return this.$store.state.task.variableLst.map(function(t){return t.varName})},slotNameList:function(){var t=this.allSlotInfoLst.map(function(t){return t.slotName});return t},curVarList:function(){var t=this.$store.state.task.variableLst.map(function(t){return t.varName}),e=this.allSlotInfoLst.map(function(t){return t.slotName});return t.concat(e),console.log("condition 当前的变量列表为: ",t),t}},data:function(){return{showDefaultTrans:!1,candTypeList:[{label:"意图",value:"intent"},{label:"槽位",value:"slot"},{label:"变量",value:"variable"},{label:"TRUE",value:"true"}],varTypeList:[{label:"变量",value:"var"},{label:"槽位",value:"slot"}],opList:["!=","==",">",">=","<","<=","in","not in","contains","not contains","is null","not null"],flowInfoList:[],nodeInfoList:[],autoInputs:["",""],lastAutoInputs:["",""],tempOpExpression:""}},methods:{deleteCondHandle:function(t,e,n){var i=this;console.log("触发删除单个条件事件: "+t+" "+e+n);var s=this.transitions[t].conditionGroup[e].conditions;this.$confirm("将要删除该条条件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.splice(n,1),i.$message({type:"success",message:"第"+n+"个条件成功删除"})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},addAndCondHandle:function(t,e){console.log("触发添加单个条件事件: "+t+" "+e);var n=this.transitions[t].conditionGroup[e].conditions,i={expected:"",expected_bak:"",opteratpr:"",property:{id:"",key:"",propertyFullName:"",propertyType:"Intent"}};n.push(i)},delOrCondHandle:function(t,e){var n=this;console.log("触发删除 and条件组事件: "+t+" "+e);var i=this.transitions[t].conditionGroup;this.$confirm("将要删除该组条件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.splice(e,1),n.$message({type:"success",message:"第"+e+"个条件组成功删除"})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},addOrCondHandle:function(t){console.log("触发添加条件组事件: "+t);var e=this.transitions[t].conditionGroup,n={conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]};e.push(n)},addGroupHandle:function(){console.log("触发条件组添加事件");var t={conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}],target:{flowName:"",nodeName:""}};this.transitions.push(t)},delGroupHandle:function(t){var e=this;console.log("触发条件组删除事件: "+t),this.$confirm("将要删除该转移分支, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.transitions.splice(t,1),e.$message({type:"success",message:"第"+and_index+"个条件组成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},delOpExpressHandle:function(t,e){var n=this;if(console.log("触发operation删除事件: "+t+" "+e),t>=0)var i=this.transitions[t].operations;else i=this.defaultTransition.operations;this.$confirm("将要删除该赋值表达式, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.splice(e,1),n.$message({type:"success",message:"第"+e+"个赋值表达式成功删除"})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},addOpExpressHandle:function(t){if(console.log("触发operation添加事件: "+t),t>=0)var e=this.transitions[t].operations;else e=this.defaultTransition.operations;var n={varType:"",varName:"",opExpression:"",opExpression_bak:""};e.push(n)},condFocusHandle:function(t,e,n){console.log(t+" "+e+" "+n+"的condition 获取焦点事件")},condBlurHandle:function(t,e,n){console.log(t+" "+e+" "+n+"的condition 失去焦点事件")},groupFocusHandle:function(t){console.log(t+" 的group target 设置组获得焦点"),this.loadFlowNameList()},intentListLoader:function(t){},varListLoader:function(t){},flowNameListLoader:function(t){},nodeNameListLoader:function(t,e){},transitionsLoader:function(t,e,n){},slotNameListLoader:function(t,e){},varListLoadHandle:function(t,e,n){var i=this.transitions[t].conditionGroup[e].conditions[n];if(""!==i&&void 0!=i)switch(i){case"intent":this.curVarList=[];break;case"slot":this.curVarList=this.slotNameListLoader(botId,flowId);break;case"variable":this.curVarList=this.varListLoader(botId);break;case"action":this.curVarList=this.slotNameListLoader(botId,flowId);break;case"default":console.log(i+" 的条件处理还没有实现"),this.$message({message:i+" 的条件处理还没有实现",showClose:!0,type:warning,during:1500});break}else console.log("当前条件的 条件类型还没赋值")},loadIntentInfoList:function(t,e){return this.$store.state.nlu.intentInfoList},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t},loadFlowNameList:function(){var t=this,e={userId:this.userId,botId:this.botId};Object(o["e"])(e).then(function(n){var i=n["data"];console.log("task列表查询参数为: ",e),console.log("加载的task列表为: ",i),void 0!==i&&i!==[]?(t.flowInfoList=i.map(function(t){return{task_name:t.taskName,task_id:t.taskId}}),t.flowInfoList.push({task_name:"QA",task_id:"QA"}),t.flowInfoList.push({task_name:"None",task_id:""})):t.flowInfoList=[{task_name:"Task",task_id:"task_1"}]}).catch(function(t){console.log("加载task列表失败!"),console.log(t)})},handleDestFlowNameChange:function(t){var e=this;if(""!==t&&void 0!==t&&"None"!==t){var n=t;"QA"===t&&(n=this.taskName);var i=this.flowInfoList.find(function(t){return t.task_name===n}),s={botId:this.botId,userId:this.userId,taskId:i.task_id};Object(o["h"])(s).then(function(t){var n=t["data"];console.log("taskflow查询参数为: ",s),console.log("加载的taskflow为: ",n),void 0!==n&&n!=={}?(e.nodeInfoList=n.taskFlow.nodes.map(function(t){return{nodeName:t.nodeName,nodeId:t.nodeId}}),e.nodeInfoList.push({nodeName:"Done",nodeId:void 0})):e.nodeInfoList=[{nodeName:"Task",nodeId:"task_1"}]}).catch(function(t){console.log("加载node列表失败!"),console.log(t)})}},queryVarAsync:function(t,e){console.log("触发回调函数")},queryVarSearchAsync:function(t,e,n){if("variable"===n||"var"===n){for(var i=[],s=0;s<this.varNameList.length;s++)i.unshift({value:this.varNameList[s]});e(i)}else if("slot"===n){i=[];for(var o=0;o<this.slotNameList.length;o++)i.unshift({value:this.slotNameList[o]});e(i)}},handleTransCondVarSelect:function(t,e,n){n.property.propertyFullName=t.value},handleTransOpVarSelect:function(t,e,n){console.log("赋值表达式的变量类型: ",e),n.varName=t.value},querySearchAsync:function(t,e){this.tempOpExpression=t,"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return slice(0,t.length)===t}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var n=[];(t.endsWith("${@}")||t.endsWith("${@"))&&(console.log("当前字符串以 ${@} 或 ${@ 结尾"),n.push({value:"slots"}),n.push({value:"vars"})),(t.endsWith("${@slots.")||t.endsWith("${@slots.}"))&&(console.log("当前字符串以 ${@slots. 或 ${@slots.} 结尾"),console.log("当前加载到的 slotNameList为: ",this.slotNameList),n=this.slotNameList.map(function(t){return{value:t}})),(t.endsWith("${@vars.")||t.endsWith("${@vars.}"))&&(console.log("当前字符串以 ${@vars. 或 ${@vars.} 结尾"),console.log("当前加载到的 varNameList为: ",this.varList),n=this.varNameList.map(function(t){return{value:t}})),e(n)},createStateFilter:function(t){return function(e){return-1!==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t,e,n){if(console.log("选中的元素: ",t,"当前的 query: ",this.lastAutoInputs[e],"传入的query: ",n),this.lastAutoInputs[e].endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.lastAutoInputs[e]),this.autoInputs[e]=this.lastAutoInputs[e]+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.lastAutoInputs[e])),this.lastAutoInputs[e].endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.lastAutoInputs[e]);var i=this.lastAutoInputs[e].length;this.autoInputs[e]=this.lastAutoInputs[e].substr(0,i-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.lastAutoInputs[e])}if((this.lastAutoInputs[e].endsWith("${@vars.")||this.lastAutoInputs[e].endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.lastAutoInputs[e]),this.autoInputs[e]=this.lastAutoInputs[e]+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.lastAutoInputs[e])),this.lastAutoInputs[e].endsWith("${@vars.}")||this.lastAutoInputs[e].endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.lastAutoInputs[e]);i=this.lastAutoInputs[e].length;this.autoInputs[e]=this.lastAutoInputs[e].substr(0,i-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.lastAutoInputs[e])}},handleTransCondSelect:function(t,e,n,i){if(console.log("选中的元素: ",t,"当前的 query: ",this.tempOpExpression),this.tempOpExpression.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression),this.transitions[e].conditionGroup[n].conditions[i].expected=this.tempOpExpression+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression);var s=this.tempOpExpression.length;this.transitions[e].conditionGroup[n].conditions[i].expected=this.tempOpExpression.substr(0,s-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)}if((this.tempOpExpression.endsWith("${@vars.")||this.tempOpExpression.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.tempOpExpression),this.transitions[e].conditionGroup[n].conditions[i].expected=this.tempOpExpression+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@vars.}")||this.tempOpExpression.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.tempOpExpression);s=this.tempOpExpression.length;this.transitions[e].conditionGroup[n].conditions[i].expected=this.tempOpExpression.substr(0,s-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.tempOpExpression)}},handleTransOpExpressSelect:function(t,e,n){if(console.log("选中的元素: ",t,"当前的 query: ",this.tempOpExpression),this.tempOpExpression.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression),this.transitions[e].operations[n].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression);var i=this.tempOpExpression.length;this.transitions[e].operations[n].opExpression=this.tempOpExpression.substr(0,i-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)}if((this.tempOpExpression.endsWith("${@vars.")||this.tempOpExpression.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.lastAutoInputs[index]),this.transitions[e].operations[n].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@vars.}")||this.tempOpExpression.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.tempOpExpression);i=this.tempOpExpression.length;this.transitions[e].operations[n].opExpression=this.tempOpExpression.substr(0,i-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.tempOpExpression)}},handleDefaultOpExpressSelect:function(t,e){if(console.log("选中的元素: ",t,"当前的 query: ",this.tempOpExpression),this.tempOpExpression.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression),this.defaultTransition.operations[e].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.tempOpExpression);var n=this.tempOpExpression.length;this.defaultTransition.operations[e].opExpression=this.tempOpExpression.substr(0,n-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.tempOpExpression)}if((this.tempOpExpression.endsWith("${@vars.")||this.tempOpExpression.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.tempOpExpression),this.defaultTransition.operations[e].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@vars.}")||this.tempOpExpression.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.tempOpExpression);n=this.tempOpExpression.length;this.defaultTransition.operations[e].opExpression=this.tempOpExpression.substr(0,n-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.tempOpExpression)}}},watch:{autoInputs:{handler:function(t,e){for(var n=0;n<t.length;n++)-1!==t[n].indexOf("${@")&&(this.lastAutoInputs[n]=t[n],console.log("监听到autoInputs发生改变，且包含${@,将其赋值给 lastAutoInput: ",t[n],this.lastAutoInputs[n]))},deep:!0},transitions:{handler:function(t,e){console.log("监听到转移条件发生变化");for(var n=0;n<this.transitions.length;n++){for(var i=this.transitions[n],s=i.operations,o=0;o<s.length;o++)-1!==s[o].opExpression.indexOf("${@")&&(this.tempOpExpression=s[o].opExpression,console.log("监听到转移条件发生变化, 暂存表达式为: ",this.tempOpExpression));for(var a=i.conditionGroup,l=0;l<a.length;l++){var r=a[l];for(o=0;o<r.length;o++){var c=r[o];-1!==c.expected.indexOf("${@")&&(this.tempOpExpression=c.expected,console.log("监听到转移赋值发生变化, 暂存表达式为: ",this.tempOpExpression))}}}},deep:!0},defaultTransition:{handler:function(t,e){for(var n=t.operations,i=0;i<n.length;i++)-1!==n[i].opExpression.indexOf("${@")&&(this.tempOpExpression=n[i].opExpression)},deep:!0}},mounted:function(){this.loadFlowNameList()}},l=a,r=(n("98df"),n("2877")),c=Object(r["a"])(l,i,s,!1,null,null,null);e["a"]=c.exports},3151:function(t,e,n){},"45b7":function(t,e,n){"use strict";var i=n("b969"),s=n.n(i);s.a},"555b":function(t,e,n){},"5b3e":function(t,e,n){},"5e9d":function(t,e,n){},"625c":function(t,e,n){},"64aa":function(t,e,n){},6914:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[t._m(1),n("div",{staticClass:"ef-condition ef-sub-section"},[n("condition-panel",{attrs:{userId:t.userId,botId:t.botId,taskName:t.taskName,has_transition:!0,transitions:t.transition.transitions,defaultTransition:t.transition.defaultTransition}})],1)])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("触发条件")])])])}],o=(n("6b54"),n("a481"),n("7514"),n("20d6"),n("2ef0")),a=n("3095"),l=n("6a3b"),r={name:"switch-form",components:{conditionPanel:a["a"],intentInfo:l["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:Object(o["cloneDeep"])(this.nodeInfo),tab_index:1,expIntentShow:!1,expIntent:"",expectIntents:[],transition:[],curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1}},methods:{handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},loadIntentInfoList:function(t,e){return console.log("回复节点加载意图列表: ",this.$store.state.nlu.intentInfoList),this.$store.state.nlu.intentInfoList},nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.expectIntents=t.nodeContent.expectIntents,this.transition=t.nodeContent.transition},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,expectIntents:this.expectIntents,transition:this.transition},this.$emit("event:update",this.node)},createInentHandle:function(){console.log("触发创建新意图事件"),this.$emit("event:createIntent")},createQueryHandle:function(){console.log("触发创建新的例句事件"),this.$emit("event:createQuery")},addReask:function(t){console.log("为槽位: "+t+"添加反问")},addAction:function(){console.log("触发添加动作的操作"),this.curActionList.push({action:"",slotOp:"",slotName:""})},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}}},watch:{},mounted:function(){this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId)}},c=r,d=(n("868b"),n("2877")),u=Object(d["a"])(c,i,s,!1,null,"33bf4354",null);e["a"]=u.exports},"6d28":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticClass:"ef-func-type"},[n("el-form",[n("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{label:"功能配置"}},[n("el-radio",{attrs:{label:"API"},model:{value:t.funcType,callback:function(e){t.funcType=e},expression:"funcType"}}),n("el-radio",{attrs:{label:"FUNC"},model:{value:t.funcType,callback:function(e){t.funcType=e},expression:"funcType"}})],1)],1)],1),"API"===t.funcType?n("div",{staticClass:"ef-inner-func"},[n("div",{staticClass:"ef-url-input",staticStyle:{"margin-top":"15px"}},[n("el-input",{staticClass:"input-with-select",attrs:{size:"small",placeholder:"请输入内容"},model:{value:t.req_url,callback:function(e){t.req_url=e},expression:"req_url"}},[n("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.req_method,callback:function(e){t.req_method=e},expression:"req_method"}},[n("el-option",{attrs:{label:"POST",value:"POST"}}),n("el-option",{attrs:{label:"GET",value:"GET"}})],1),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("div",{staticClass:"ef-edit-params",staticStyle:{padding:"8px 20px"}},[n("el-tabs",{model:{value:t.apiSetTab,callback:function(e){t.apiSetTab=e},expression:"apiSetTab"}},[n("el-tab-pane",{attrs:{label:"Header",name:"header"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.headerData}},[n("el-table-column",{attrs:{label:"name",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index==t.editIndex&&"header"===t.apiSetTab?n("el-input",{attrs:{size:"small"},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}}):t._e(),e.$index!=t.editIndex?n("span",[t._v("\n                                            "+t._s(e.row.name)+"\n                                        ")]):t._e()]}}],null,!1,4225890642)}),n("el-table-column",{attrs:{label:"value",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index==t.editIndex&&"header"===t.apiSetTab,expression:"scope.$index == editIndex &&\n                                        apiSetTab === 'header'"}],attrs:{size:"small"},model:{value:e.row.entityValue,callback:function(n){t.$set(e.row,"entityValue",n)},expression:"scope.row.entityValue"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.editIndex,expression:"scope.$index != editIndex"}]},[t._v("\n                                            "+t._s(e.row.value)+"\n                                        ")])]}}],null,!1,2995580942)}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                         \n                                        "),e.$index==t.editIndex&&"header"===t.apiSetTab?n("i",{staticClass:"el-icon-folder-add",on:{click:function(n){return t.saveHeaderParams(e.$index)}}}):t._e(),e.$index!=t.editIndex?n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.editHeaderParams(e.$index)}}}):t._e(),t._v("\n                                         \n                                        "),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.delHeaderParams(e.$index)}}})]}}],null,!1,208351210)})],1),n("span",{on:{click:t.addHeaderParams}},[t._v("+ 新增参数 ")])],1),n("el-tab-pane",{attrs:{label:"Query",name:"query"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.queryData}},[n("el-table-column",{attrs:{label:"name",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index==t.editIndex&&"query"===t.apiSetTab?n("el-input",{attrs:{size:"small"},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.editIndex,expression:"scope.$index != editIndex"}]},[t._v("\n                                            "+t._s(e.row.name)+"\n                                        ")])]}}],null,!1,1702381447)}),n("el-table-column",{attrs:{prop:"value",label:"value",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index==t.editIndex&&"query"===t.apiSetTab?n("el-input",{attrs:{size:"small"},model:{value:e.row.value,callback:function(n){t.$set(e.row,"value",n)},expression:"scope.row.value"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.editIndex,expression:"scope.$index != editIndex"}]},[t._v("\n                                            "+t._s(e.row.value)+"\n                                        ")])]}}],null,!1,681993607)}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                         \n                                        "),e.$index==t.editIndex&&"query"===t.apiSetTab?n("i",{staticClass:"el-icon-folder-add",on:{click:function(n){return t.saveQueryParams(e.$index)}}}):t._e(),e.$index!=t.editIndex?n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.editQueryParams(e.$index)}}}):t._e(),t._v("\n                                         \n                                        "),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.delQueryParams(e.$index)}}})]}}],null,!1,968823850)})],1),n("span",{on:{click:t.addQueryParams}},[t._v("+ 新增参数 ")])],1),n("el-tab-pane",{attrs:{label:"Body",name:"body"}},[n("el-input",{attrs:{type:"textarea",maxlength:"30",autosize:{minRows:8,maxRows:8}},model:{value:t.payload,callback:function(e){t.payload=e},expression:"payload"}})],1),n("el-tab-pane",{attrs:{label:"Result",name:"result"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.resultMap}},[n("el-table-column",{attrs:{label:"result",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index==t.editIndex&&"result"===t.apiSetTab?n("el-input",{attrs:{size:"small"},model:{value:e.row.result,callback:function(n){t.$set(e.row,"result",n)},expression:"scope.row.result"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.editIndex,expression:"scope.$index != editIndex"}]},[t._v("\n                                            "+t._s(e.row.result)+"\n                                        ")])]}}],null,!1,1776566884)}),n("el-table-column",{attrs:{prop:"value",label:"variable",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index==t.editIndex&&"result"===t.apiSetTab?n("el-input",{attrs:{size:"small"},model:{value:e.row.variable,callback:function(n){t.$set(e.row,"variable",n)},expression:"scope.row.variable"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.editIndex,expression:"scope.$index != editIndex"}]},[t._v("\n                                            "+t._s(e.row.variable)+"\n                                        ")])]}}],null,!1,3355925124)}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                         \n                                        "),e.$index==t.editIndex&&"result"===t.apiSetTab?n("i",{staticClass:"el-icon-folder-add",on:{click:function(n){return t.saveResultMap(e.$index)}}}):t._e(),e.$index!=t.editIndex?n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.editResultMap(e.$index)}}}):t._e(),t._v("\n                                         \n                                        "),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.delResultMap(e.$index)}}})]}}],null,!1,2970603018)})],1),n("span",{on:{click:t.addResultMap}},[t._v("+ 新增参数 ")])],1)],1)],1)]):t._e(),"FUNC"===t.funcType?n("div",{staticClass:"ef-edit-func"},[n("el-form",{ref:"form",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"服务"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"small"},model:{value:t.serviceName,callback:function(e){t.serviceName=e},expression:"serviceName"}})],1),n("el-form-item",{attrs:{label:"函数"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"small"},model:{value:t.funcName,callback:function(e){t.funcName=e},expression:"funcName"}})],1),n("el-form-item",[n("div",{staticStyle:{"text-align":"right",padding:"0px 50px 0px 0px"}},[n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.showCodeHandle()}}},[t._v("查看代码")]),n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.editFuncHandle()}}},[t._v("新建函数")])],1)])],1)],1):t._e()]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[t._m(1),n("div",{staticClass:"ef-condition ef-sub-section"},[n("condition-panel",{attrs:{userId:t.userId,botId:t.botId,taskName:t.taskName,has_transition:!0,transitions:t.transition.transitions,defaultTransition:t.transition.defaultTransition}})],1)])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1)])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("函数配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("转移分支")])])])}],o=n("2ef0"),a=n("3095"),l={name:"func-form",components:{conditionPanel:a["a"]},props:{nodeInfo:{type:Object,default:function(){return{text:""}}},userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"}},data:function(){return{visible:!0,type:"node",apiSetTab:"header",editIndex:-1,tab_index:2,req_url:"",queryData:[],headerData:[],resultMap:[],payload:"",node:Object(o["cloneDeep"])(this.nodeInfo),funcType:"API",serviceName:"",funcName:"",activeTab:"first",req_method:"post",transition:{}}},methods:{handleClick:function(t,e){console.log(t,e)},nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.funcType=t.nodeContent.funcType,this.req_url=t.nodeContent.req_url,this.req_method=t.nodeContent.req_method,this.queryData=t.nodeContent.queryData,this.payload=t.nodeContent.payload,this.resultMap=t.nodeContent.resultMap,this.serviceName=t.nodeContent.serviceName,this.funcName=t.nodeContent.funcName,this.transition=t.nodeContent.transition},showCodeHandle:function(){console.log("触发显示代码内容事件")},editFuncHandle:function(){console.log("触发新建函数事件")},addHeaderParams:function(){this.headerData.push({name:"",value:""}),this.editIndex=this.headerData.length-1},delHeaderParams:function(t){this.headerData.splice(t,1),this.editIndex=-1},editHeaderParams:function(t){this.editIndex=t},saveHeaderParams:function(t){this.editIndex=-1},addQueryParams:function(){this.queryData.push({name:"",value:""}),this.editIndex=this.queryData.length-1},delQueryParams:function(t){this.queryData.splice(t,1),this.editIndex=-1},editQueryParams:function(t){this.editIndex=t},saveQueryParams:function(t){this.editIndex=-1},addResultMap:function(){this.resultMap.push({result:"",variable:""}),this.editIndex=this.resultMap.length-1},editResultMap:function(t){this.editIndex=t},saveResultMap:function(t){this.editIndex=-1},delResultMap:function(t){this.resultMap.splice(t,1),this.editIndex=-1},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,funcType:this.funcType,req_url:this.req_url,req_method:this.req_method,queryData:this.queryData,payload:this.payload,resultMap:this.resultMap,serviceName:this.serviceName,funcName:this.funcName,transition:this.transition},this.$emit("event:update",this.node)}},mounted:function(){this.nodeInit(this.nodeInfo)},watch:{}},r=l,c=(n("45b7"),n("2877")),d=Object(c["a"])(r,i,s,!1,null,"590c857d",null);e["a"]=d.exports},"6fa9":function(t,e,n){},7522:function(t,e,n){"use strict";var i=n("8b75"),s=n.n(i);s.a},"7b56":function(t,e,n){},8123:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"option-container"},[n("div",{staticClass:"ef-assign-group"},[t._l(t.operations,function(e,i){return n("div",{key:i,staticClass:"ef-op-elem"},[n("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"变量类型"},model:{value:e.varType,callback:function(n){t.$set(e,"varType",n)},expression:"operation.varType"}},t._l(t.varTypeList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v("\n\n             \n\n            "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"240px"},attrs:{size:"mini","trigger-on-focus":!0,"fetch-suggestions":function(n,i){t.queryVarSearchAsync(n,i,e.varType)},placeholder:"请输入内容"},on:{select:function(n){return t.handleTransOpVarSelect(n,e.varType,e)}},model:{value:e.varName,callback:function(n){t.$set(e,"varName",n)},expression:"operation.varName"}}),t._v("\n\n\n\n               =  \n            "),n("br"),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"400px","margin-top":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(e){return t.handleSelect(e,i)}},model:{value:e.opExpression,callback:function(n){t.$set(e,"opExpression",n)},expression:"operation.opExpression"}}),n("div",{staticClass:"ef-op-del"},[n("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.delOpExpressHandle(i)}}})])],1)}),n("div",{staticClass:"ef-op-add",on:{click:function(e){return t.addOpExpressHandle()}}},[t._v("   + 增加转移赋值表达式")])],2)])},s=[],o=(n("aef6"),n("ac6a"),{name:"option-set",props:{userId:{type:String,default:""},botId:{type:String,default:""},operations:{type:Array,default:function(){return[{varType:"",varName:"a",opExpression:"a+1",opExpression_bak:""}]}}},computed:{intentList:function(){return this.loadIntentInfoList(this.userId,this.botId)},allSlotInfoLst:function(){return this.buildAllSlotConfLst()},intentNameList:function(){return this.intentList.map(function(t){return t.intentName})},varNameList:function(){var t=this.$store.state.task.variableLst.map(function(t){return t.varName});return t},slotNameList:function(){var t=this.allSlotInfoLst.map(function(t){return t.slotName});return t},curVarList:function(){var t=this.$store.state.task.variableLst.map(function(t){return t.varName}),e=this.allSlotInfoLst.map(function(t){return t.slotName});return t.concat(e),console.log("condition 当前的变量列表为: ",t),t}},watch:{operations:function(t,e){for(var n=0;n<t.length;n++)-1!==t[n].opExpression.indexOf("${@")&&(this.tempOpExpression=t[n].opExpression,console.log("监听到autoinputs 发生改变 且包含${@,将其赋值给 lastAutoInput: ",t[n].opExpression,this.tempOpExpression))}},data:function(){return{varTypeList:[{label:"变量",value:"var"},{label:"槽位",value:"slot"}],autoInputs:["",""],lastAutoInputs:["",""],tempOpExpression:""}},mounted:function(){},methods:{queryVarSearchAsync:function(t,e,n){if("variable"===n||"var"===n){for(var i=[],s=0;s<this.varNameList.length;s++)i.unshift({value:this.varNameList[s]});e(i)}else if("slot"===n){i=[];for(var o=0;o<this.slotNameList.length;o++)i.unshift({value:this.slotNameList[o]});e(i)}},handleTransOpVarSelect:function(t,e,n){console.log("赋值表达式的变量类型: ",e),n.varName=t.value},loadIntentInfoList:function(t,e){var n=this.$store.state.nlu.intentInfoList;return console.log("当前加载的意图列表为: ",n),n},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t},querySearchAsync:function(t,e){this.tempOpExpression=t,"function"!=typeof String.prototype.startswith&&(String.prototype.startsWith=function(t){return slice(0,t.length)===t}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var n=[];(t.endsWith("${@}")||t.endsWith("${@"))&&(console.log("当前字符串以 ${@} 或 ${@ 结尾"),n.push({value:"slots"}),n.push({value:"vars"})),(t.endsWith("${@slots.")||t.endsWith("${@slots.}"))&&(console.log("当前字符串以 ${@slots.} 或 ${@slots. 结尾"),console.log("当前加载到的 slotNamelist为: ",this.slotNameList),n=this.slotNameList.map(function(t){return{value:t}})),(t.endsWith("${@vars.")||t.endsWith("${@vars.}"))&&(console.log("当前字符串以 ${@vars.} 或 ${@vars. 结尾"),console.log("当前加载到的 varNameList为: ",this.varList),n=this.varNameList.map(function(t){return{value:t}})),e(n)},createStateFilter:function(t){return function(e){return-1!==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t,e){if(console.log("选中的元素: ",t,"当前的query: ",this.tempOpExpression),this.tempOpExpression.endsWith("${@")&&(console.log("当前是以占位符结尾， 替换前 query为:",this.tempOpExpression),this.operations[e].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符结尾， 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@}")){console.log("当前是以占位符结尾， 替换前query为:",this.tempOpExpression);var n=this.tempOpExpression.length;this.operations[e].opExpression=this.tempOpExpression.substr(0,n-1)+t.value+"}",console.log("当前是以占位符结尾， 替换前query为: ",this.tempOpExpression)}if((this.tempOpExpression.endsWith("${@vars.")||this.tempOpExpression.endsWith("${@slots.}"))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾， 替换前 query为: ",this.tempOpExpression),this.operations[e].opExpression=this.tempOpExpression+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾， 替换后 query为: ",this.tempOpExpression)),this.tempOpExpression.endsWith("${@vars.}")||this.tempOpExpression.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.} 结尾， 替换前 query为: ",this.tempOpExpression);n=this.tempOpExpression.length;this.operations[e].opExpression=this.tempOpExpression.substr(0,n-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.} 结尾， 替换后 query为: ",this.tempOpExpression)}},delOpExpressHandle:function(t){var e=this;console.log("触发删除后处理表达式事件: "+t),this.$confirm("将要删除该赋值表达式, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.operations.splice(t,1),e.$message({type:"success",message:"第"+t+"个赋值表达式成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addOpExpressHandle:function(){var t={varType:"",varName:"",opExpression:"",opExpression_bak:""};this.operations.push(t)}}}),a=o,l=(n("07de"),n("2877")),r=Object(l["a"])(a,i,s,!1,null,null,null);e["a"]=r.exports},"868b":function(t,e,n){"use strict";var i=n("1c89"),s=n.n(i);s.a},"8b75":function(t,e,n){},"92ba":function(t,e,n){},"971d":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[n("div",{staticStyle:{margin:"20px 0px 20px 20px"}},[n("span",[t._v(" 设为默认任务流: ")]),n("el-switch",{model:{value:t.default_taskflow,callback:function(e){t.default_taskflow=e},expression:"default_taskflow"}})],1),t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2),t._m(1),n("conditionPanel",{attrs:{has_transition:!1,transitions:t.trigger}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(2),n("div",[n("span",[t._v("    跳过开始节点:    ")]),n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.skip_start,callback:function(e){t.skip_start=e},expression:"skip_start"}})],1),n("div",{staticClass:"ef-start-set"},[n("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("     问候语:     ")]),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"300px"},attrs:{type:"textarea",rows:"2","fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:t.handleSelect},model:{value:t.start_sentence,callback:function(e){t.start_sentence=e},expression:"start_sentence"}})],1),n("br"),t._m(3),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明文字说明","show-icon":""}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.actionList,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.deleteAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addAction}},[t._v("添加对话动作")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("触发条件")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("开始语句")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("动作配置")])])])}],o=(n("aef6"),n("f559"),n("6b54"),n("a481"),n("7514"),n("20d6"),n("ac6a"),n("2ef0")),a=n("3095"),l=n("6a3b"),r={name:"start-form",components:{conditionPanel:a["a"],intentInfo:l["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:{},default_taskflow:!1,skip_start:!0,tab_index:1,actionOptions:["inform","deform","confirm","request","negate","yn","deny","dontcare","reqmore","repeat","change"],expIntentShow:!1,expIntent:"",expectIntents:[],intentList:[],allSlotInfoLst:[],start_sentence:"",start_sentence_backup:"",actionList:[],trigger:[],curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1}},methods:{nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.default_taskflow=this.node.nodeContent.default_taskflow,this.expectIntents=this.node.nodeContent.expectIntents,this.trigger=this.node.nodeContent.trigger,this.skip_start=this.node.nodeContent.skip_start,this.start_sentence=this.node.nodeContent.start_sentence,this.actionList=this.node.nodeContent.actionList},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,default_taskflow:this.default_taskflow,expectIntents:this.expectIntents,trigger:this.trigger,skip_start:this.skip_start,start_sentence:this.start_sentence,actionList:this.actionList},this.$emit("event:update",this.node)},loadIntentInfoList:function(t,e){return this.$store.state.nlu.intentInfoList},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t},handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},addAction:function(){console.log("触发添加动作的操作"),this.actionList.push({action:"",slotOp:"",slotName:""})},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.actionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},querySearchAsync:function(t,e){"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return slice(0,t.length)===t}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var n=[];(t.endsWith("${@}")||t.endsWith("${@"))&&(console.log("当前字符串以 ${@} 或 ${@ 结尾"),n.push({value:"slots"}),n.push({value:"vars"})),(t.endsWith("${@slots.")||t.endsWith("${@slots.}"))&&(console.log("当前字符串以 ${@slots. 或 ${@slots.} 结尾"),console.log("当前加载到的 slotNameList为: ",this.slotNameList),n=this.slotNameList.map(function(t){return{value:t}})),(t.endsWith("${@vars.")||t.endsWith("${@vars.}"))&&(console.log("当前字符串以 ${@vars. 或 ${@vars.} 结尾"),console.log("当前加载到的 varNameList为: ",this.varList),n=this.varNameList.map(function(t){return{value:t}})),e(n)},createStateFilter:function(t){return function(e){return-1!==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){if(console.log("选中的元素: ",t,"当前的 query: ",this.start_sentence_backup),this.start_sentence_backup.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.start_sentence_backup),this.start_sentence=this.start_sentence_backup+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.start_sentence)),this.start_sentence_backup.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.start_sentence_backup);var e=this.start_sentence_backup.length;this.start_sentence=this.start_sentence_backup.substr(0,e-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.start_sentence_backup)}if((this.start_sentence_backup.endsWith("${@vars.")||this.start_sentence_backup.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.lastAutoInputs[index]),this.start_sentence=this.start_sentence_backup+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.start_sentence_backup)),this.start_sentence_backup.endsWith("${@vars.}")||this.start_sentence_backup.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.start_sentence_backup);e=this.start_sentence_backup.length;this.start_sentence=this.start_sentence_backup.substr(0,e-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.start_sentence_backup)}}},watch:{start_sentence:{handler:function(t,e){-1!==t.indexOf("${@")&&(this.start_sentence_backup=t,console.log("监听到autoInputs发生改变，且包含${@,将其赋值给 lastAutoInput: ",t,this.start_sentence_backup))},deep:!0}},mounted:function(){console.log("开始表单 mounted 函数"),this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId),console.log("加载的意图列表为: ",this.intentList),this.allSlotInfoLst=this.buildAllSlotConfLst()},computed:{varNameList:function(){return this.$store.state.task.variableLst.map(function(t){return t.varName})},slotNameList:function(){var t=this.allSlotInfoLst.map(function(t){return t.slotName});return t}}},c=r,d=(n("f09b"),n("2877")),u=Object(d["a"])(c,i,s,!1,null,null,null);e["a"]=u.exports},"98df":function(t,e,n){"use strict";var i=n("5e9d"),s=n.n(i);s.a},a57c:function(t,e,n){"use strict";var i=n("3151"),s=n.n(i);s.a},a870:function(t,e,n){},aa77:function(t,e,n){var i=n("5ca1"),s=n("be13"),o=n("79e5"),a=n("fdef"),l="["+a+"]",r="​",c=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),u=function(t,e,n){var s={},l=o(function(){return!!a[t]()||r[t]()!=r}),c=s[t]=l?e(p):a[t];n&&(s[n]=c),i(i.P+i.F*l,"String",s)},p=u.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(d,"")),t};t.exports=u},aea0:function(t,e,n){"use strict";var i=n("555b"),s=n.n(i);s.a},aef6:function(t,e,n){"use strict";var i=n("5ca1"),s=n("9def"),o=n("d2c8"),a="endsWith",l=""[a];i(i.P+i.F*n("5147")(a),"String",{endsWith:function(t){var e=o(this,t,a),n=arguments.length>1?arguments[1]:void 0,i=s(e.length),r=void 0===n?i:Math.min(s(n),i),c=String(t);return l?l.call(e,c,r):e.slice(r-c.length,r)===c}})},b969:function(t,e,n){},ba68:function(t,e,n){"use strict";var i=n("6fa9"),s=n.n(i);s.a},bdb2:function(t,e,n){"use strict";var i=n("ddea"),s=n.n(i);s.a},c5f6:function(t,e,n){"use strict";var i=n("7726"),s=n("69a8"),o=n("2d95"),a=n("5dbc"),l=n("6a99"),r=n("79e5"),c=n("9093").f,d=n("11e9").f,u=n("86cc").f,p=n("aa77").trim,f="Number",h=i[f],m=h,x=h.prototype,v=o(n("2aeb")(x))==f,b="trim"in String.prototype,g=function(t){var e=l(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():p(e,3);var n,i,s,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,s=49;break;case 79:case 111:i=8,s=55;break;default:return+e}for(var a,r=e.slice(2),c=0,d=r.length;c<d;c++)if(a=r.charCodeAt(c),a<48||a>s)return NaN;return parseInt(r,i)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(v?r(function(){x.valueOf.call(n)}):o(n)!=f)?a(new m(g(e)),n,h):g(e)};for(var y,_=n("9e1e")?c(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;_.length>I;I++)s(m,y=_[I])&&!s(h,y)&&u(h,y,d(m,y));h.prototype=x,x.constructor=h,n("2aba")(i,f,h)}},cf32:function(t,e,n){"use strict";var i=n("7b56"),s=n.n(i);s.a},d5ff:function(t,e,n){},d787:function(t,e,n){"use strict";var i=n("a870"),s=n.n(i);s.a},d828:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(1),n("div",{staticClass:"transition"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("转移目标")]),t._v("\n                   "),n("span",[t._v("目标对话流:")]),t._v(" \n                "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:t.groupFocusHandle},model:{value:t.flowName,callback:function(e){t.flowName=e},expression:"flowName"}},t._l(t.flowNameList,function(t){return n("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}),1),t._v("\n\n                   "),n("span",[t._v("目标节点:")]),t._v(" \n                "),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:""},on:{focus:t.groupFocusHandle},model:{value:t.nodeName,callback:function(e){t.nodeName=e},expression:"nodeName"}},t._l(t.nodeNameList,function(t){return n("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}),1)],1),t._m(2),n("div",{staticClass:"ef-before-into"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.beforeInto,height:"150",size:"small"}},[n("el-table-column",{attrs:{label:"变量类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.row.varType,callback:function(n){t.$set(e.row,"varType",n)},expression:"scope.row.varType"}},t._l(t.varTypeList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]}}])}),n("el-table-column",{attrs:{label:"变量名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.row.varName,callback:function(n){t.$set(e.row,"varName",n)},expression:"scope.row.varName"}},[t._l(t.varNameList,function(t){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:"var"===e.row.varType,expression:"scope.row.varType === 'var'"}],key:t.value,attrs:{label:t.label,value:t.value}})}),t._l(t.slotNameList,function(t){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:"slot"===e.row.varType,expression:"scope.row.varType === 'slot'"}],key:t.value,attrs:{label:t.label,value:t.value}})})],2)]}}])}),n("el-table-column",{attrs:{label:"",width:"10"}},[[t._v("\n                           =\n                        ")]],2),n("el-table-column",{attrs:{label:"表达式",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"180px","margin-left":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(n){return t.handleIntoSelect(n,e.$index)}},model:{value:e.row.opExpression,callback:function(n){t.$set(e.row,"opExpression",n)},expression:"scope.row.opExpression"}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.handleDeleteIntoSet(e.$index)}}})]}}])})],1),n("div",{staticClass:"ef-op-add",on:{click:t.handleAddIntoSet}},[t._v("   + 增加进入子流程前设置")])],1),t._m(3),n("div",{staticClass:"ef-before-resume"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.beforeResume,height:"150",size:"small"}},[n("el-table-column",{attrs:{label:"变量类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.row.varType,callback:function(n){t.$set(e.row,"varType",n)},expression:"scope.row.varType"}},t._l(t.varTypeList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]}}])}),n("el-table-column",{attrs:{label:"变量名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.row.varName,callback:function(n){t.$set(e.row,"varName",n)},expression:"scope.row.varName"}},[t._l(t.varNameList,function(t){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:"var"===e.row.varType,expression:"scope.row.varType === 'var'"}],key:t.value,attrs:{label:t.label,value:t.value}})}),t._l(t.slotNameList,function(t){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:"slot"===e.row.varType,expression:"scope.row.varType === 'slot'"}],key:t.value,attrs:{label:t.label,value:t.value}})})],2)]}}])}),n("el-table-column",{attrs:{label:"",width:"10"}},[[t._v("\n                           =\n                        ")]],2),n("el-table-column",{attrs:{label:"子任务参数",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"180px","margin-left":"2px"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1,size:"mini"},on:{select:function(n){return t.handleResumeSelect(n,e.$index)}},model:{value:e.row.opExpression,callback:function(n){t.$set(e.row,"opExpression",n)},expression:"scope.row.opExpression"}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.handleDeleteResumeSet(e.$index)}}})]}}])})],1),n("div",{staticClass:"ef-op-add",on:{click:t.handleAddResumeSet}},[t._v("   + 增加退出子流程设置")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[t._m(4),n("div",{staticClass:"ef-condition ef-sub-section"})])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("子对话流设置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("进入子环境设置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("跳出子环境设置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("转移分支")])])])}],o=(n("aef6"),n("f559"),n("ac6a"),n("6b54"),n("a481"),n("7514"),n("20d6"),n("2ef0")),a=n("3095"),l=n("6a3b"),r=n("eee3"),c={name:"sub-bot-form",components:{conditionPanel:a["a"],intentInfo:l["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:Object(o["cloneDeep"])(this.nodeInfo),tab_index:2,expIntentShow:!1,expIntent:"",expectIntents:[],intentList:[],allSlotInfoLst:[],varInfoLst:[],taskInfoList:[],flowNameList:[],nodeNameList:[],flowName:"",nodeName:"",beforeInto:[{varType:"",varName:"",opExpression:""}],beforeResume:[{varType:"",varName:"",opExpression:""}],opExpression_bak:"",varTypeList:[{label:"变量",value:"var"},{label:"槽位",value:"slot"}],varNameList:[],slotNameList:[],curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1}},methods:{nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.expectIntents=t.nodeContent.expectIntents,this.flowName=t.nodeContent.flowName,this.nodeName=t.nodeContent.nodeName,this.beforeInto=t.nodeContent.beforeInto,this.beforeResume=t.nodeContent.beforeResume},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,expectIntents:this.expectIntents,flowName:this.flowName,nodeName:this.nodeName,beforeInto:this.beforeInto,beforeResume:this.beforeResume,transition:this.transition},this.$emit("event:update",this.node)},loadIntentInfoList:function(t,e){return this.$store.state.nlu.intentInfoList},handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},groupFocusHandle:function(t){console.log(t+" 的group target 设置组获得焦点")},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleDeleteIntoSet:function(t){var e=this;console.log("触发删除第: ",t," 个 进入子流程设置事件"),this.$confirm("将要删除该条进入子流程前设置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.beforeInto.splice(t,1),e.$message({type:"success",message:"第"+t+"个进入子流程前设置成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleDeleteResumeSet:function(t){var e=this;console.log("触发删除第: ",t," 个 退出子流程设置事件"),this.$confirm("将要删除该条退出子流程后设置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.beforeResume.splice(t,1),e.$message({type:"success",message:"第"+t+"个退出子流程后设置成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleAddIntoSet:function(){console.log("触发添加进入子流程前操作事件");var t={destVarType:"",destVarName:"",dest_value:"",srcVarType:"",srcVarName:"",src_value:""};this.beforeInto.push(t)},handleAddResumeSet:function(){console.log("触发添加退出子流程前操作事件");var t={destVarType:"",destVarName:"",dest_value:"",srcVarType:"",srcVarName:"",src_value:""};this.beforeResume.push(t)},extractAllSlotConfLst:function(t){var e=[];return t.forEach(function(t){t.slotInfoLst.forEach(function(t){e.push({slotName:t.slotName,entityName:t.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),e},querySearchAsync:function(t,e){this.opExpression_bak=t,"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return slice(0,t.length)===t}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var n=[];(t.endsWith("${@}")||t.endsWith("${@"))&&(console.log("当前字符串以 ${@} 或 ${@ 结尾"),n.push({value:"slots"}),n.push({value:"vars"})),(t.endsWith("${@slots.")||t.endsWith("${@slots.}"))&&(console.log("当前字符串以 ${@slots. 或 ${@slots.} 结尾"),console.log("当前加载到的 slotNameList为: ",this.slotNameList),n=this.slotNameList.map(function(t){return{value:t}})),(t.endsWith("${@vars.")||t.endsWith("${@vars.}"))&&(console.log("当前字符串以 ${@vars. 或 ${@vars.} 结尾"),console.log("当前加载到的 varNameList为: ",this.varList),n=this.varNameList.map(function(t){return{value:t}})),e(n)},createStateFilter:function(t){return function(e){return-1!==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleIntoSelect:function(t,e){if(console.log("选中的元素: ",t,"当前的 query: ",this.opExpression_bak),this.opExpression_bak.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.opExpression_bak),this.beforeInto[e].opExpression=this.opExpression_bak+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.opExpression_bak)),this.opExpression_bak.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.opExpression_bak);var n=this.opExpression_bak.length;this.beforeInto[e].opExpression=this.opExpression_bak.substr(0,n-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.opExpression_bak)}if((this.opExpression_bak.endsWith("${@vars.")||this.opExpression_bak.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.opExpression_bak),this.beforeInto[e].opExpression=this.opExpression_bak+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.opExpression_bak)),this.opExpression_bak.endsWith("${@vars.}")||this.opExpression_bak.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.opExpression_bak);n=this.opExpression_bak.length;this.beforeInto[e].opExpression=this.opExpression_bak.substr(0,n-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.opExpression_bak)}},handleResumeSelect:function(t,e){if(console.log("选中的元素: ",t,"当前的 query: ",this.opExpression_bak),this.opExpression_bak.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.opExpression_bak),this.beforeResume[e].opExpression=this.opExpression_bak+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.opExpression_bak)),this.opExpression_bak.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.opExpression_bak);var n=this.opExpression_bak.length;this.beforeResume[e].opExpression=this.opExpression_bak.substr(0,n-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.opExpression_bak)}if((this.opExpression_bak.endsWith("${@vars.")||this.opExpression_bak.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.opExpression_bak),this.beforeResume[e].opExpression=this.opExpression_bak+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.opExpression_bak)),this.opExpression_bak.endsWith("${@vars.}")||this.opExpression_bak.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.opExpression_bak);n=this.opExpression_bak.length;this.beforeResume[e].opExpression=this.opExpression_bak.substr(0,n-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.opExpression_bak)}}},watch:{flowName:{handler:function(t,e){var n=this;if(void 0!==t&&""!==t){var i={userId:this.userId,botId:this.botId,taskId:this.taskInfoList.find(function(e){return e.taskName===t}).taskId};Object(r["h"])(i).then(function(t){var e=t.data["taskFlow"]["nodes"];n.nodeNameList=e.map(function(t){return{value:t.nodeName,label:t.nodeName}})}).catch(function(t){console.log("加载子流程节点信息失败!")})}},immediate:!0},beforeInto:{handler:function(t,e){console.log("监听到 BeforeInfo 发生变动!",t);for(var n=0;n<t.length;n++)-1!==t[n].opExpression.indexOf("${@")&&(this.opExpression_bak=t[n].opExpression)},deep:!0},beforeResume:{handler:function(t,e){console.log("监听到 beforeResume 发生变动!",t);for(var n=0;n<t.length;n++)-1!==t[n].opExpression.indexOf("${@")&&(this.opExpression_bak=t[n].opExpression)},deep:!0}},mounted:function(){var t=this;this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId),this.allSlotInfoLst=this.extractAllSlotConfLst(this.intentList),this.varInfoLst=this.$store.state.task.variableLst.map(function(t){return t.varName});var e={userId:this.userId,botId:this.botId};Object(r["e"])(e).then(function(e){t.taskInfoList=e.data,t.flowNameList=t.taskInfoList.map(function(t){return{value:t.taskName,label:t.taskName}}),console.log("加载到的 任务信息列表为: ",t.flowNameList)}).catch(function(t){console.log("加载任务信息列表失败!")}),this.varNameList=this.varInfoLst.map(function(t){return t}),console.log("加载的中的全局变量列表为: ",this.varNameList),this.slotNameList=this.allSlotInfoLst.map(function(t){return t.slotName}),console.log("加载的中的槽位列表为: ",this.slotNameList)}},d=c,u=(n("081e"),n("2877")),p=Object(u["a"])(d,i,s,!1,null,null,null);e["a"]=p.exports},ddea:function(t,e,n){},e1f3:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticStyle:{"border-top":"0px 0px 1px 0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(1),n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"文字说明文字说明文字说明","show-icon":""}}),n("div",{staticClass:"ef-intent ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 回复动作名: ")]),t._v("\n                     \n                "),n("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入机器人动作名",size:"small"},model:{value:t.responseAction,callback:function(e){t.responseAction=e},expression:"responseAction"}})],1),n("div",{staticClass:"ef-resp-type ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 回复类型: ")]),t._v("\n                         \n                "),n("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"请选择回复类型"},model:{value:t.responseType,callback:function(e){t.responseType=e},expression:"responseType"}},t._l(t.responseTypeList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),n("div",{staticClass:"ef-query ef-sub-section"},[t._v("\n                  \n                "),n("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("* 机器人回复:   ")]),t._v("\n                  \n                "),n("el-autocomplete",{staticClass:"el-input",staticStyle:{width:"300px"},attrs:{type:"textarea",rows:"2","fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:t.handleSelect},model:{value:t.responseContent,callback:function(e){t.responseContent=e},expression:"responseContent"}})],1),t._m(2),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"文字说明文字说明文字说","show-icon":""}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curActionList,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"默认槽位",value:"default"}}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.deleteAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addAction}},[t._v("添加对话动作")])],1),t._m(3),n("div",{staticClass:"ef-intent ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 引导动作名: ")]),t._v("\n                  \n                "),n("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入机器人动作名",size:"small"},model:{value:t.guideAction,callback:function(e){t.guideAction=e},expression:"guideAction"}})],1),n("div",{staticClass:"ef-guide-sentence"},[n("span",[t._v("   * 引导语:            ")]),n("el-input",{staticStyle:{width:"350px"},attrs:{size:"small",placeholder:"输入引导语"},model:{value:t.guidSentence,callback:function(e){t.guidSentence=e},expression:"guidSentence"}})],1),t._m(4),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"文字说明文字说明文字说","show-icon":""}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.guideActionList,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.deleteGuideAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addGuideAction}},[t._v("添加对话动作")])],1),t._m(5),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.goalSlotList,"max-height":"200",border:"",size:"small"}},[n("el-table-column",{attrs:{prop:"slotName",label:"槽名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{directives:[{name:"show",rawName:"v-show",value:t.curSlotIndex===e.$index,expression:"curSlotIndex === scope.$index"}],attrs:{size:"small",placeholder:"请选择"},on:{change:function(n){return t.handleSlotInfoConfirm(e.$index)}},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"默认槽位",value:"default"}}),n("el-option",{attrs:{label:"无槽位",value:""}})],2),n("span",{directives:[{name:"show",rawName:"v-show",value:t.curSlotIndex!==e.$index,expression:"curSlotIndex !== scope.$index"}]},[t._v(t._s(e.row.slotName))])]}}])}),n("el-table-column",{attrs:{label:"实体名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                            "+t._s(e.row.entityName)+"\n                        ")]}}])}),n("el-table-column",{attrs:{prop:"resp",label:"回复配置"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.addUtts(e.$index)}}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curSlotIndex,expression:"scope.$index === curSlotIndex"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveGoalSlot(e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curSlotIndex,expression:"scope.$index !== curSlotIndex "}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editGoalSlot(e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.delGoalSlot(e.$index)}}})]}}])})],1),t._v("\n\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addGoalSlot}},[t._v("添加附带目标配置")])],1),t._m(6),n("div",{staticClass:"ef-after-active"},[n("span",[t._v("   回复后动作:   ")]),n("el-select",{attrs:{size:"small",placeholder:"回复后动作"},model:{value:t.afterActive,callback:function(e){t.afterActive=e},expression:"afterActive"}},t._l(t.afterActiveList,function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[t._m(7),n("after-set",{attrs:{userId:t.userId,botId:t.botId,operations:t.afterSettings}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"定义话术",visible:t.showUttEdit,modal:!1,width:"80%"},on:{"update:visible":function(e){t.showUttEdit=e}}},[n("div",{staticStyle:{height:"420px",overflow:"scroll"}},[n("el-form",[n("el-divider",{attrs:{"content-position":"center"}},[t._v("Inform 话术: ")]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.info_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform")}}},[t._v("+ 增加话术")])],1)]),n("el-divider",{attrs:{"content-position":"center"}},[t._v("Request 话术: ")]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.req_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'request'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("request",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'request'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("request",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("request",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("request")}}},[t._v("+ 增加话术")])],1)]),n("el-divider",{attrs:{"content-position":"center"}},[t._v(" Confirm 话术: ")]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.confirm_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'confirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("confirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'confirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("confirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("confirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("confirm")}}},[t._v("+ 增加话术")])],1)]),n("el-divider",{attrs:{"content-position":"center"}},[t._v(" Disconfirm 话术: ")]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.disconfirm,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'disconfirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("disconfirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'disconfirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("disconfirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("disconfirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("disconfirm")}}},[t._v("+ 增加话术")])],1)]),n("el-divider",{attrs:{"content-position":"center"}},[t._v(" Inform Add 话术: ")]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.inform_add,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform_add'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform_add",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'inform_add'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform_add",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform_add",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform_add")}}},[t._v("+ 增加话术")])],1)])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelAddUtts}},[t._v("取 消")]),n("el-button",{on:{click:t.confirmAddUtts}},[t._v("确 定")])],1)]),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("回复配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("回复动作配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("引导语句配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("引导动作配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("附属目标回答配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("回复后动作")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v(" 执行后动作")])])])}],o=(n("aef6"),n("f559"),n("6b54"),n("a481"),n("ac6a"),n("7514"),n("20d6"),n("bd86")),a=n("2ef0"),l=n("3095"),r=n("6a3b"),c=n("8123"),d={name:"bot-form",components:{conditionPanel:l["a"],intentInfo:r["a"],afterSet:c["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){var t;return t={tab_index:2,visible:!0,type:"node",node:Object(a["cloneDeep"])(this.nodeInfo),expIntentShow:!1,expIntent:"",expectIntents:[],intentList:[]},Object(o["a"])(t,"intentList",[]),Object(o["a"])(t,"allSlotInfoLst",[]),Object(o["a"])(t,"showUttEdit",!1),Object(o["a"])(t,"curUtts",[]),Object(o["a"])(t,"curSlotType",""),Object(o["a"])(t,"curSlotIndex",-1),Object(o["a"])(t,"curUttType",""),Object(o["a"])(t,"curUttIndex",-1),Object(o["a"])(t,"actionOptions",["inform","deform","confirm","request","negate","yn","deny","dontcare","reqmore","repeat","change"]),Object(o["a"])(t,"responseTypeList",["文本回复","卡片回复","选择列表","是否按钮"]),Object(o["a"])(t,"responseAction",""),Object(o["a"])(t,"responseType",""),Object(o["a"])(t,"responseContent",""),Object(o["a"])(t,"responseContent_backup",""),Object(o["a"])(t,"guidSentence",""),Object(o["a"])(t,"guideAction",""),Object(o["a"])(t,"guideActionList",[]),Object(o["a"])(t,"curActionList",[]),Object(o["a"])(t,"goalSlotList",[]),Object(o["a"])(t,"afterActive",""),Object(o["a"])(t,"afterActiveList",["Listen","Finish","Yeild","ToHuman","Append"]),Object(o["a"])(t,"curIntentInfo",{}),Object(o["a"])(t,"curIntentIndex",-1),Object(o["a"])(t,"showIntentEditDialog",!1),Object(o["a"])(t,"afterSettings",[]),t},methods:{nodeInit:function(t){this.type="node",this.node=Object(a["cloneDeep"])(t),this.expectIntents=t.nodeContent.expectIntents,this.responseType=t.nodeContent.responseType,this.responseAction=t.nodeContent.responseAction,this.responseContent=t.nodeContent.responseContent,this.guidSentence=t.nodeContent.guidSentence,this.guideAction=t.nodeContent.guideAction,this.guideActionsLst=t.nodeContent.guideActionList,this.curActionList=t.nodeContent.actionList,this.goalSlotList=t.nodeContent.goalSlotList,this.afterActive=t.nodeContent.afterActive,this.afterSettings=void 0!==t.nodeContent.afterSettings?t.nodeContent.afterSettings:[]},handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},loadIntentInfoList:function(t,e){return console.log("回复节点加载意图列表: ",this.$store.state.nlu.intentInfoList),this.$store.state.nlu.intentInfoList},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t.push({slotName:"default",entityName:"default",isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}),t},handleSlotInfoConfirm:function(t){var e=this,n=this.allSlotInfoLst.find(function(n){return n.slotName===e.goalSlotList[t].slotName});console.log("slot source: ",n),this.goalSlotList[t]={slotName:n.slotName,entityName:n.entityName,isRequie:!0,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete",this.node.id)},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,expectIntents:this.expectIntents,responseType:this.responseType,responseAction:this.responseAction,responseContent:this.responseContent,guidSentence:this.guidSentence,guideAction:this.guideAction,guideActionsLst:this.guideActionList,actionList:this.curActionList,goalSlotList:this.goalSlotList,afterActive:this.afterActive,afterSettings:this.afterSettings},this.$emit("event:update",this.node)},createInentHandle:function(){console.log("触发创建新意图事件"),this.$emit("event:createIntent")},createQueryHandle:function(){console.log("触发创建新的例句事件"),this.$emit("event:createQuery")},addUtts:function(t){console.log(" 为槽位: "+t+"添加话术"),this.curUtts=this.goalSlotList[t].utts,console.log("当前的 目标槽位列表为: ",this.goalSlotList),console.log("当前话术为: ",this.curUtts),this.showUttEdit=!0},addUttItem:function(t){"inform"===t?this.curUtts.info_utts.push({utt:""}):"request"===t?this.curUtts.req_utts.push({utt:""}):"confirm"===t?this.curUtts.confirm_utts.push({utt:""}):"disconfirm"===t?this.curUtts.disconfirm.push({utt:""}):"inform_add"===t&&this.curUtts.inform_add.push({utt:""}),this.$message({type:"success",message:"增加一条"+t+"话术"}),console.log("添加一条话术")},deleteUttItem:function(t,e){var n=this,i=this;i.$confirm("将要删除当前话术, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"inform"===t?n.curUtts.info_utts.splice(e,1):"request"===t?n.curUtts.req_utts.splice(e,1):"confirm"===t?n.curUtts.confirm_utts.splice(e,1):"disconfirm"===t?n.curUtts.disconfirm.splice(e,1):"inform_add"===t&&n.curUtts.inform_add.splice(e,1),i.$message({type:"success",message:"当前话术成功删除"})}).catch(function(){i.$message({type:"info",message:"已取消话术删除"})})},editUttItem:function(t,e){console.log("触发编辑话术"),this.curUttType=t,this.curUttIndex=e,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},saveUttItem:function(t,e){console.log("触发保存话术"),this.curUttType="",this.curUttIndex=-1,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},cancelAddUtts:function(){this.showUttEdit=!1},confirmAddUtts:function(){this.showUttEdit=!1},addAction:function(){console.log("触发添加动作的操作"),this.curActionList.push({action:"",slotOp:"",slotName:""})},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addGuideAction:function(){console.log("触发添加动作的操作"),this.guideActionList.push({action:"",slotOp:"",slotName:""})},deleteGuideAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.guideActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addGoalSlot:function(){var t={slotName:"",entityName:"",resp:{inform:"",yn:""}};this.goalSlotList.push(t)},delGoalSlot:function(t){var e=this;this.$confirm("将要删除该目标槽位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.goalSlotList.splice(t,1),e.$message({type:"success",message:"第"+t+"个目标槽位成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editGoalSlot:function(t){this.curSlotIndex=t},saveGoalSlot:function(t){this.curSlotIndex=-1},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},querySearchAsync:function(t,e){"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return slice(0,t.length)===t}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var n=[];(t.endsWith("${@}")||t.endsWith("${@"))&&(console.log("当前字符串以 ${@} 或 ${@ 结尾"),n.push({value:"slots"}),n.push({value:"vars"})),(t.endsWith("${@slots.")||t.endsWith("${@slots.}"))&&(console.log("当前字符串以 ${@slots. 或 ${@slots.} 结尾"),console.log("当前加载到的 slotNameList为: ",this.slotNameList),n=this.slotNameList.map(function(t){return{value:t}})),(t.endsWith("${@vars.")||t.endsWith("${@vars.}"))&&(console.log("当前字符串以 ${@vars. 或 ${@vars.} 结尾"),console.log("当前加载到的 varNameList为: ",this.varList),n=this.varNameList.map(function(t){return{value:t}})),e(n)},createStateFilter:function(t){return function(e){return-1!==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){if(console.log("选中的元素: ",t,"当前的 query: ",this.responseContent_backup),this.responseContent_backup.endsWith("${@")&&(console.log("当前是以占位符结尾, 替换前 query为: ",this.responseContent_backup),this.responseContent=this.responseContent_backup+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.responseContent)),this.responseContent_backup.endsWith("${@}")){console.log("当前是以占位符结尾, 替换前 query为: ",this.responseContent_backup);var e=this.responseContent_backup.length;this.responseContent=this.responseContent_backup.substr(0,e-1)+t.value+"}",console.log("当前是以占位符结尾, 替换后 query为: ",this.responseContent_backup)}if((this.responseContent_backup.endsWith("${@vars.")||this.responseContent_backup.endsWith("${@slots."))&&(console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换前 query为: ",this.responseContent_backup),this.responseContent=this.responseContent_backup+t.value+"}",console.log("当前是以占位符${@vars. 或 ${@slots.结尾, 替换后 query为: ",this.responseContent_backup)),this.responseContent_backup.endsWith("${@vars.}")||this.responseContent_backup.endsWith("${@slots.}")){console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换前 query为: ",this.responseContent_backup);e=this.responseContent_backup.length;this.responseContent=this.responseContent_backup.substr(0,e-1)+t.value+"}",console.log("当前是以占位符${@vars.} 或 ${@slots.}结尾, 替换后 query为: ",this.responseContent_backup)}}},watch:{responseContent:{handler:function(t,e){-1!==t.indexOf("${@")&&(this.responseContent_backup=t,console.log("监听到autoInputs发生改变，且包含${@,将其赋值给 lastAutoInput: ",t,this.responseContent_backup))},deep:!0}},mounted:function(){this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId),this.allSlotInfoLst=this.buildAllSlotConfLst()},computed:{varNameList:function(){return this.$store.state.task.variableLst.map(function(t){return t.varName})},slotNameList:function(){var t=this.allSlotInfoLst.map(function(t){return t.slotName});return t}}},u=d,p=(n("7522"),n("2877")),f=Object(p["a"])(u,i,s,!1,null,"d4bc0430",null);e["a"]=f.exports},e88d:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"graph-editor"}},[n("NodePanel",{ref:"nodePanel",attrs:{jsp:t.jsp},on:{"update-pos":t.updatePosition}}),n("OpPanel",{ref:"opBtnPanel",on:{opBtnEvent:t.processOpBtnEvent}}),n("GraphCanvas",{ref:"graphCanvas",attrs:{userId:t.userId,botId:t.botId,taskId:t.taskId,taskName:t.taskName,jsp:t.jsp,pos:t.pos},on:{canvasScroll:t.processCanvasScroll}})],1)},s=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-panel"},t._l(t.node_type_list,function(e,i){return n("div",{key:i,staticClass:"item"},[n("div",{ref:e.type,refInFor:!0,class:e.cls_arr,style:e.bordercolor},[n("el-tooltip",{staticClass:"item",attrs:{effect:"light","open-delay":t.tipOpenDelay,content:e.name,placement:"right-end"}},[n("i",{class:e.iconclass,style:e.iconstyle})])],1)])}),0)},a=[],l={name:"node-panel",props:{jsp:{type:Object}},data:function(){return{node_type_list:[{type:"start",name:"开始节点",cls_arr:["start","center"],iconclass:"iconfont icon-kaishi",iconstyle:"color:#5CB87A; font-size:25px;"},{type:"user",name:"用户语句节点",cls_arr:["user","center"],iconclass:"iconfont icon-ziyuan1",iconstyle:"color:#64bcc2;font-size:25px;"},{type:"slot",name:"槽位填充节点",cls_arr:["slot","center"],iconclass:"iconfont icon-liebiao1",iconstyle:"color:#FFCC66; font-size: 25px;"},{type:"bot",name:"机器人回复节点",cls_arr:["bot","center"],iconclass:"iconfont icon-rengongzhineng",iconstyle:"color:#e691c0; font-size: 25px;"},{type:"func",name:"函数节点",cls_arr:["func center"],iconclass:"iconfont icon-Luahanshu",iconstyle:"color:#9b6fc3; font-size: 25px;"},{type:"switch",name:"条件转移节点",cls_arr:["switch center"],iconclass:"iconfont icon-leixing-fenzhijiedian",iconstyle:"color:#71a7d1; font-size: 25px !important;"},{type:"subbot",name:"预制子流程节点",cls_arr:["subbot center"],iconclass:"iconfont icon-liucheng9",iconstyle:"color: #F39C12; font-size: 25px;"},{type:"time",name:"定时节点",cls_arr:["time center"],iconclass:"iconfont icon-lishijilu",iconstyle:"color:#F56C6C; font-size: 25px !important;"},{type:"qa",name:"问答节点",cls_arr:["qa center"],iconclass:"iconfont icon-qa4",iconstyle:"color:#34495E; font-size: 25px !important;"},{type:"kg",name:"知识图谱节点",cls_arr:["kg center"],iconclass:"iconfont icon-tupu2",iconstyle:"color:#95A5A6; font-size: 25px !important;"}],tipOpenDelay:1e3}},methods:{init:function(){var t=this;this.jsp.draggable([this.$refs.start,this.$refs.user,this.$refs.bot,this.$refs.func,this.$refs.switch,this.$refs.subbot,this.$refs.qa,this.$refs.kg,this.$refs.slot,this.$refs.time],{clone:!0,drag:function(e){t.$emit("update-pos",e.pos)}})}},mounted:function(){this.init()}},r=l,c=(n("bdb2"),n("2877")),d=Object(c["a"])(r,o,a,!1,null,"3473bf94",null),u=d.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"ef-canvas-container",staticClass:"canvas-container",attrs:{id:"canvas-container"}},[n("drawer",{attrs:{inner:!1,mask:!1,title:t.formTitle,display:t.dialogVisible},on:{"update:display":function(e){t.dialogVisible=e}}},[void 0!==t.nodeFormName?n(t.nodeFormName,{tag:"component",attrs:{nodeInfo:t.info,userId:t.userId,botId:t.botId,taskName:t.taskName},on:{"event:cancel":t.closeDialog,"event:update":t.summit,"event:delete":t.nodeDelHandle}}):t._e()],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.show_minimap,expression:"show_minimap"}],staticClass:"ef-zoom-controller"},[n("el-slider",{attrs:{min:-50,max:50,tyle:"float:right;"},model:{value:t.zoom_val,callback:function(e){t.zoom_val=e},expression:"zoom_val"}}),n("i",{staticClass:"el-icon-refresh-left",staticStyle:{"font-size":"19px",color:"#409EFF",display:"inline-block",float:"left"},on:{click:function(e){t.zoom_val=0}}})],1),n("div",{ref:"right",staticClass:"graph-canvas",style:t.canvas_size,attrs:{id:"canvas"},on:{mousedown:function(e){return t.mouseDown(e)},mouseup:function(e){return t.mouseUp(e)},mousemove:function(e){return t.mouseMove(e)}}},[t._l(t.nodes,function(e,i){return[n("div",{key:i,ref:"nodes",refInFor:!0,staticClass:"node",class:e.className,style:e.style,attrs:{id:e.nodeId},on:{dblclick:function(n){return t.editNodeText(e)}}},[n("el-row",[n("el-col",{attrs:{span:4}},[n("i",{class:e.iconfont_set.iconclass,style:e.iconfont_set.iconstyle})]),n("el-col",{attrs:{span:18}},[n("div",{staticClass:"ef-node-content"},[t._v("\n                  "+t._s(e.nodeName?e.nodeName:" ")+"\n                ")])]),n("el-col",{attrs:{span:2}},[n("i",{staticClass:"el-icon-more",staticStyle:{color:"#999999",transform:"rotate(90deg)"},on:{click:function(n){return n.stopPropagation(),t.onContextmenu(n,e)}}})])],1)],1)]})],2),t.show_minimap?n("MiniMap",{attrs:{datas:t.datas,canvasPos:t.canvas_pos,targetSize:t.canvas_size,zoomVal:t.zoom_val}}):t._e()],1)},f=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"drawer"},[n("div",{class:t.maskClass,on:{click:t.closeByMask}}),n("div",{staticClass:"main",class:t.mainClass,style:t.mainStyle},[n("div",{staticClass:"drawer-head"},[n("div",{staticClass:"header-expand"},[n("span",{on:{click:function(e){return t.changeSideWidth("change width",e)}}},[n("i",{staticClass:"el-icon-arrow-left"})])]),n("div",{staticClass:"header-title"},[n("span",[t._v(t._s(t.title))])]),n("div",{staticClass:"header-close"},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.closable,expression:"closable"}],staticClass:"close-btn",on:{click:t.closeByButton}},[n("i",{staticClass:"el-icon-s-unfold"})])])]),n("div",{staticClass:"drawer-body"},[t._t("default")],2)])])},m=[],x={props:{display:{type:Boolean},title:{type:String,default:"标题"},closable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},width:{type:String,default:"500px"},inner:{type:Boolean,default:!1}},data:function(){return{}},computed:{maskClass:function(){return{"mask-show":this.mask&&this.display,"mask-hide":!(this.mask&&this.display),inner:this.inner}},mainClass:function(){return{"main-show":this.display,"main-hide":!this.display,inner:this.inner}},mainStyle:function(){return{width:this.width,right:this.display?"0":"-".concat(this.width),borderLeft:this.mask?"none":"1px solid #eee"}}},mounted:function(){if(this.inner){var t=this.$el.parentNode;t.style.position="relative"}},methods:{closeByMask:function(){this.maskClosable&&this.$emit("update:display",!1)},closeByButton:function(){this.$emit("update:display",!1)},changeSideWidth:function(t,e){var n=e.currentTarget,i=n.parentNode.parentNode.parentNode;i.style.width="500px"===i.style.width?"800px":"500px",n.innerHTML="500px"===i.style.width?'<i class="el-icon-arrow-left"></i>':'<i class="el-icon-arrow-right"></i>'}}},v=x,b=(n("1ca5"),Object(c["a"])(v,h,m,!1,null,"16eb062e",null)),g=b.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"minimap"}},[n("div",{attrs:{id:"selectWin"}},[n("div",{staticClass:"selectionWin",attrs:{id:"selectionWindow"},on:{mousedown:t.mouseDown}})]),n("div",{attrs:{id:"miniview"}},[n("div",{staticClass:"mini-canvas",attrs:{id:"miniContainer"}},t._l(t.nodes,function(e){return t.nodes.length?n("div",{ref:"nodes",refInFor:!0,staticClass:"node",class:e.className,style:e.style,attrs:{id:e.id},on:{dblclick:function(n){return t.editNodeText(e)}}},[n("i",{class:e.iconfont_set.iconclass,style:e.iconfont_set.iconstyle}),t._v("\n            "+t._s(e.text))]):t._e()}),0)])])},_=[],I=(n("28a5"),n("c5f6"),{selectWinScale:1,dragModel:function(t,e){var n=0,i=0;t=t||window.event;n=t.pageX-e.offsetLeft,i=t.pageY-e.offsetTop,isDragging=True,document.onmousemove=function(t){t=t||window.event;var s=t.pageX,o=t.pageY,a=0,l=0;if(!0===isDragging){a=s-n,l=o-i;var r=document.documentElement.clientWidth,c=(document.documentElement.clientHeight,e.offsetWidth),d=(e.offsetHeight,r-c);a=Math.max(0,max),a=Math.min(d,a),l=Math.max(0,l),l=Math.min(maxy,l),e.style.left=a+"px",e.style.top=l+"px"}},document.onmouseup=function(){isDragging=!1}},dragInParentDiv:function(t,e,n){var i=document.getElementById(e),s=i.parentElement,o=document.getElementById(n),a=!0;i.addEventListener("mousemove",function(t){if(a){var e=t||window.event,l=e.pageX-s.offsetLeft-.5*i.offsetWidth,r=e.pageY-s.offsetTop-.5*i.offsetWidth;l<0?l=0:l>s.offsetWidth-i.offsetWidth-39&&(l=s.offsetWidth-i.offsetWidth-39),r<0?r=0:r>s.offsetHeight-i.offsetHeight-4&&(r=s.offsetHeight-i.offsetHeight-4),i.style.left=l+"px",i.style.top=r+"px",null!=n&&""!==n&&(o.style.left=-l/(s.offsetWidth/o.offsetWidth)+"px",o.style.top=-r/(s.offsetHeight/o.offsetHeight)+"px")}}),i.addEventListener("mouseup",function(t){a=!1,i.onmousemove=null,i.onmouseup=null})}}),w={start:{iconclass:"iconfont icon-kaishi",iconstyle:"color:#5CB87A; font-size:25px;",color:"#5CB87A"},user:{iconclass:"iconfont icon-ziyuan1",iconstyle:"color:#64bcc2;font-size:25px;",color:"#64bcc2"},bot:{iconclass:"iconfont icon-rengongzhineng",iconstyle:"color:#e691c0; font-size: 25px;",color:"#e691c0"},slot:{iconclass:"iconfont icon-liebiao1",iconstyle:"color:#FFCC66; font-size: 25px;",color:"#FFCC66"},func:{iconclass:"iconfont icon-Luahanshu",iconstyle:"color:#9b6fc3; font-size: 25px;",color:"#9b6fc3"},switch:{iconclass:"iconfont icon-leixing-fenzhijiedian",iconstyle:"color:#71a7d1; font-size: 25px !important;",color:"#71a7d1"},subbot:{iconclass:"iconfont icon-liucheng9",iconstyle:"color: #F39C12; font-size: 25px;",color:"#F39C12"},time:{iconclass:"iconfont icon-lishijilu",iconstyle:"color:#F56C6C; font-size: 25px !important;",color:"#F56C6C"},qa:{iconclass:"iconfont icon-qa4",iconstyle:"color:#34495E; font-size: 25px !important;",color:"#34495E"},kg:{iconclass:"iconfont icon-tupu2",iconstyle:"color:#95A5A6; font-size: 25px !important;",color:"#95A5A6"}},k=["Left","Right","Top","Bottom"],C={stroke:"#5fc1ee",strokeWidth:2,joinstyle:"round",outlineStroke:"transparent",outlineWidth:10},N={stroke:"orange",strokeWidth:2,outlineStroke:"orange",outlineWidth:1,overlays:[["PlainArrow",{width:12,length:12,location:.5}]]},S={fill:"transparent",stroke:"#7AB02C",radius:1,strokeWidth:1},$={fill:"#5c96bc",stroke:"#5c96bc",radius:0,strokeWidth:0},E={anchor:"AutoDefault",connector:"Flowchart",endpoint:"Dot",paintStyle:C,hoverPaintStyle:N,endpointStyle:S,maxConnections:5,endpointHoverStyle:$},L={isSource:!0,isTarget:!0,connector:["Flowchart"],maxConnections:-1,endpoint:"Dot",paintStyle:{strokeWidth:0},hoverPaintStyle:{outlineStroke:"gray",strokeWidth:1.5,radius:5},connectorStyle:C,connectorHoverStyle:N},T={name:"MiniMap",props:{datas:{type:Object,default:function(){}},zoom:{type:Number,default:1},viewZoom:{type:Number,default:1},canvasPos:{type:Object,default:function(){}},targetSize:{type:Object,default:function(){}},zoomVal:{type:Number,default:0}},data:function(){return{mjsp:this.$jsplumb.getInstance({ConnectionOverlays:[["Arrow",{location:1,id:"arrow",width:11,length:11}],["Label",{location:.3,id:"label",cssClass:"jsp-label"}]]}),zoomNum:{x:.125,y:.125},SwZooNum:{x:1,y:1},nodes:{}}},methods:{init:function(){var t=this;this.nodes=this.datas.nodes,this.$nextTick(function(){t._initNodes(t.$refs.nodes)})},reload:function(t){var e=this;this.clearAll(),this.nodes=t.nodes,this.$nextTick(function(){e._initNodes(e.$refs.nodes)})},clearAll:function(){this.mjsp.reset(),this.nodes=[]},_initNode:function(t){var e=this;this.mjsp.draggable(t,{constrain:!0,grid:[0,0]}),k.map(function(n){return e.mjsp.addEndpoint(t,L,{anchor:n})}),this.mjsp.makeTarget(t)},_initNodes:function(t){var e=this;t.map(function(t){return e._initNode(t)})},_initEdges:function(t){var e=this;t.map(function(t){return e.mjsp.connect(t,E).getOverlay("label").setLabel(t.labelText)})},mouseDown:function(t){var e="selectionWindow",n="canvas";I.dragInParentDiv(t,e,n)},getPos:function(t){var e=document.documentElement.scrollTop||document.body.scrollTop,n=document.documentElement.scrollLeft||document.body.scrollLeft;return{x:t.clientX+n,y:t.clientY+e}},setZoom:function(t){var e=document.getElementById("miniContainer");document.getElementById("miniview");console.log("执行缩小操作"),console.log(e);var n="left top";e.style["transform"]="scale("+t+")",e.style["transformOrigin"]=n},setZoomXY:function(t,e){var n=document.getElementById("miniContainer");document.getElementById("miniview");console.log("执xy行缩小操作"),console.log(n);var i="left top";n.style["transform"]="scale("+t+" , "+e+")",n.style["transformOrigin"]=i},setSwZoomXY:function(t,e){var n=document.getElementById("selectionWindow");console.log("执行选择窗缩小"),n.style.width=100*t+"px",n.style.height=100*e+"px"}},mounted:function(){console.log("mini map接收到的 nodes props: "+this.nodes),console.log("收到主画布位置",this.canvasPos.top,this.canvasPos.left),console.log("收到 目标的size: ",this.targetSize);var t=this.targetSize["width"].split("px"),e=t[0]-0,n=this.targetSize["height"].split("px"),i=n[0]-0,s=document.getElementById("miniContainer");s.style.width=e+"px",s.style.height=i+"px",console.log("当前zoonNum: "+this.zoomNum.x+" "+this.zoomNum.y);this.init(),this.setZoomXY(this.zoomNum.x,this.zoomNum.y),this.mjsp.importDefaults({ConnectionsDetachable:!1})},watch:{datas:{handler:function(t,e){console.log("接收到数据:"),console.log(t),this.reload(t),this.setZoomXY(this.zoomNum.x,this.zoomNum.y)},deep:!0,immediate:!0},zoomVal:{handler:function(t,e){var n=this.targetSize["width"].split("px"),i=n[0]-0,s=this.targetSize["height"].split("px"),o=s[0]-0;this.SwZooNum={x:2e3/(i*(t+100)/100),y:2e3/(o*(t+100)/100)},console.log("监听到 canvas 的放缩事件:",this.SwZooNum.x,this.SwZooNum.y),this.setSwZoomXY(this.SwZooNum.x,this.SwZooNum.y)}},canvasPos:{handler:function(t,e){console.log("监听到主画布移动: ",t.top,t.left);var n=this.targetSize["width"].split("px"),i=n[0]-0,s=this.targetSize["height"].split("px"),o=s[0]-0,a=this.canvasPos["left"].split("px"),l=a[0]-0,r=this.canvasPos["top"].split("px"),c=r[0]-0,d=250/(i*(this.zoomVal+100)/100),u=250/(o*(this.zoomVal+100)/100);console.log("移动放缩: ",d,u),console.log("移动值: ",-c*u,-l*d);var p=document.getElementById("selectionWindow");p.style.left=-l*d+"px",p.style.top=-c*u+"px"}},targetSize:{handler:function(t,e){if(t["width"]!==e["width"]||t["height"]!==e["height"]){console.log("目标画布size 发成变动",t,e);var n=t["width"].split("px"),i=n[0]-0,s=t["height"].split("px"),o=s[0]-0,a=document.getElementById("miniContainer");a.style.width=i+"px",a.style.height=o+"px",this.zoomNum={x:250/i,y:250/o},this.SwZooNum={x:2e3/(i*(this.zoomVal+100)/100),y:2e3/(o*(this.zoomVal+100)/100)},this.setZoomXY(this.zoomNum.x,this.zoomNum.y),this.setSwZoomXY(this.SwZooNum.x,this.SwZooNum.y),console.log("当前zoonNum: "+this.zoomNum.x+" "+this.zoomNum.y)}}}}},U=T,z=(n("cf32"),Object(c["a"])(U,y,_,!1,null,"63ed2be6",null)),q=z.exports;function O(){return{default_taskflow:!1,expectIntents:[],trigger:[{conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]}],skip_start:!0,start_sentence:"",actionList:[{action:"",slotOp:"",slotName:""}]}}function A(){return{endSentence:"",endAction:"",transition:{transitions:[{conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}],target:{flowName:"",nodeName:""}}],defaultTransition:{target:{flowName:"",nodeName:""},operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]}}}}function D(){return{trigger:[{conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]}],expectIntents:[],selectedIntent:"",selectedQuery:"",queryExamples:[{selectedIntent:"",selectedQuery:""}],intentInfos:[{}],infoSlotList:[{slotName:"",entityName:"",tagVal:"",startPos:-1,endPost:-1,isRequie:!0,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}],reqSlotList:[{slotName:"",entityName:"",isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}],actionList:[{action:"",slotOp:"",slotName:""}],confirmConfig:[{slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""}],afterSettings:[]}}function j(){return{expectIntents:[],curSlotList:[{slotName:"",entityName:"",isRequire:!0,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}],confirmConfig:[{slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""}],afterSettings:[]}}function W(){return{expectIntents:[],responseType:"",responseAction:"",responseContent:"",guidSentence:"",guideAction:"",guideActionsLst:[{action:"",slotOp:"",slotName:""}],actionList:[{action:"",slotOp:"",slotName:""}],goalSlotList:[{slotName:"",entityName:"",isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}],afterActive:"",afterSettings:[]}}function F(){return{funcType:"API",req_url:"",req_method:"POST",queryData:[],payload:"",resultMap:[],serviceName:"",funcName:"",afterActive:"",transition:{defaultTransition:{target:{flowName:"",nodeName:""},operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]},transitions:[{conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}],target:{flowName:"",nodeName:""}}]}}}function B(){return{expectIntents:[],transition:{defaultTransition:{target:{flowName:"",nodeName:""},operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]},transitions:[{conditionGroup:[{conditions:[{expected:"",expected_bak:"",opterator:"",property:{id:"",key:"",propertyFullName:"",propertyType:""}}]}],operations:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}],target:{flowName:"",nodeName:""}}]}}}function H(){return{expectIntents:[],flowName:"",nodeName:"",beforeInto:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}],beforeResume:[{varType:"",varName:"",opExpression:"",opExpression_bak:""}]}}function R(){return{expectIntents:[],serviceName:"",funcName:"",active_resp_action:"",active_resp_type:"",active_resp_template:"",active_action_list:[{action:"",slotOp:"",slotName:""}],notify_resp_action:"",notify_resp_type:"",notify_resp_template:"",notify_action_list:[{action:"",slotOp:"",slotName:""}]}}function P(t){var e={};switch(t){case"start":e=O();break;case"user":e=D();break;case"bot":e=W();break;case"slot":e=j();break;case"func":e=F();break;case"switch":e=B();break;case"subbot":e=H();break;case"end":e=A();break;case"time":e=R();break;default:e={}}return e}var Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"node",staticClass:"node",class:t.node.className,style:t.node.style,on:{click:t.clikcNode,mouseup:t.changeNodeSite,dblclick:function(e){return t.editNodeText(t.node)}}},[n("i",{class:t.node.iconfont_set.iconclass,style:t.node.iconfont_set.iconstyle}),t._v("\n\n      "+t._s(t.node.nodeName)+"\n  \n")])},M=[],V={props:{node:Object,activeElement:Object},data:function(){return{}},methods:{clickNode:function(){this.$emit("clickNode",this.node.id)},changeNodeSite:function(){this.node.left==this.$refs.node.style.left&&this.node.top==this.$refs.node.style.top||this.$emit("changeNodeSite",{nodeId:this.node.id,left:this.refs.node.style.left,top:this.$fefs.node.style.top})}}},G=V,Y=Object(c["a"])(G,Q,M,!1,null,"60cd2fa2",null),Z=Y.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),t._m(0),n("div",{staticClass:"ef-intent ef-sub-section"},[t._v("\n              \n            "),n("span",[t._v("* 选择意图: ")]),t._v("\n              \n            "),n("el-select",{attrs:{filterable:"","allow-create":"",size:"small",placeholder:"请选择"},model:{value:t.selectedIntent,callback:function(e){t.selectedIntent=e},expression:"selectedIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intent_id,attrs:{label:t.intent_name,value:t.intent_id}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"},on:{click:function(e){return t.createInentHandle()}}})],2)],1),n("div",{staticClass:"ef-query ef-sub-section"},[t._v("\n              \n            "),n("span",[t._v("* 选择例句:")]),t._v("\n              \n            "),n("el-select",{attrs:{id:"ef-query-select",filterable:"","allow-create":"",size:"small",placeholder:"请选择"},model:{value:t.selectedQuery,callback:function(e){t.selectedQuery=e},expression:"selectedQuery"}},[t._l(t.queryList,function(t,e){return n("el-option",{key:e,attrs:{label:t.query,value:e}})}),n("el-option",{attrs:{label:"创建例句",value:"newQuery"},on:{click:function(e){return t.createQueryHandle()}}})],2)],1),t._m(1),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curSlotList,"max-height":"200",border:"",size:"small"}},[n("el-table-column",{attrs:{prop:"isRequie",label:"必填",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isRequie,callback:function(n){t.$set(e.row,"isRequie",n)},expression:"scope.row.isRequie"}})]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"槽名",width:"80"}}),n("el-table-column",{attrs:{prop:"entityName",label:"实体名",width:"100"}}),n("el-table-column",{attrs:{prop:"isArray",label:"数组",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isArray,callback:function(n){t.$set(e.row,"isArray",n)},expression:"scope.row.isArray"}})]}}])}),n("el-table-column",{attrs:{prop:"reAsk",label:"反问"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.addReask(e.row.slotName)}}})]}}])})],1)],1),t._m(2),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curActionList,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.curSlotList,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.deleteAction(e.$index)}}})]}}])})],1),t._v("\n                "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addAction}},[t._v("添加对话动作")])],1),t._m(3),t._m(4),n("div",{staticClass:"ef-condition ef-sub-section"},[n("condition-panel")],1)]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1)])},K=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("问句设置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("槽位配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("动作配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("触发条件")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("触发条件")])])])}],J=n("2ef0"),tt=n("3095"),et={name:"baseform",components:{conditionPanel:tt["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:Object(J["cloneDeep"])(this.nodeInfo),tab_index:1,actionOptions:["inform","deform","confirm","require","negate","yn","deny","dontcare","reqmore","repeat","change"],selectedIntent:"",intentList:[{intent_name:"买火车票",intent_id:"intent_1"},{intent_name:"查天气",intent_id:"intent_2"},{intent_name:"播音乐",intent_id:"intent_3"}],selectedQuery:"",queryList:[{query:"我要买一张去北京的火车票",slotInfo:[{slotName:"to",entityName:"@sys.city",isRequie:!0,isArray:!1,reAsk:[""]}],actionInfo:[{action:"inform",slotOp:"=",slotName:"to"}]},{query:"我要买一张明天去北京的火车票",slotInfo:[{slotName:"to",entityName:"@sys.city",isRequie:!0,isArray:!1,reAsk:[""]},{slotName:"date",entityName:"@sys.date",isRequie:!0,isArray:!1,reAsk:[""]}],actionInfo:[{action:"inform",slotOp:"=",slotName:"to"},{action:"inform",slotOp:"=",slotName:"date"}]},{query:"我要买一张明天从上海到北京的火车票",slotInfo:[{slotName:"from",entityName:"@sys.city",isRequie:!0,isArray:!1,reAsk:[""]},{slotName:"to",entityName:"@sys.city",isRequie:!0,isArray:!1,reAsk:[""]},{slotName:"date",entityName:"@sys.date",isRequie:!0,isArray:!1,reAsk:[""]}],actionInfo:[{action:"inform",slotOp:"=",slotName:"to"},{action:"inform",slotOp:"=",slotName:"from"},{action:"inform",slotOp:"=",slotName:"date"}]}],curSlotList:[],curActionList:[]}},methods:{nodeInit:function(t,e){this.type="node",this.node=Object(J["cloneDeep"])(t)},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+node.className+"node Name: "+node.nodeName+" node id: "+nodeNodeId},this.$emit("event:update",this.node)},createInentHandle:function(){console.log("触发创建新意图事件"),this.$emit("event:createIntent")},createQueryHandle:function(){console.log("触发创建新的例句事件"),this.$emit("event:createQuery")},addReask:function(t){console.log("为槽位: "+t+"添加反问")},addAction:function(){console.log("触发添加动作的操作"),this.curActionList.push({action:"",slotOp:"",slotName:""})},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}},watch:{selectedIntent:function(t){"newIntent"===t&&this.createInentHandle()},selectedQuery:function(t){"newQuery"===t?this.createQueryHandle():(this.curSlotList=this.queryList[t].slotInfo,this.curActionList=this.queryList[t].actionInfo,console.log("当前的槽位信息为: "),console.log(this.curSlotList))}}},nt=et,it=(n("a57c"),Object(c["a"])(nt,X,K,!1,null,null,null)),st=it.exports,ot=n("2a82"),at=n("e1f3"),lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"",size:"mini","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(1),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.curSlotList,"max-height":"400",border:"",size:"small"}},[n("el-table-column",{attrs:{prop:"isRequie",label:"必填",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isRequie,callback:function(n){t.$set(e.row,"isRequie",n)},expression:"scope.row.isRequie"}})]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"槽名",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index===t.curSlotIndex?n("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:function(n){return t.handleSlotInfoConfirm(e.$index)}},model:{value:t.editSlotName,callback:function(e){t.editSlotName=e},expression:"editSlotName"}},t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotId,attrs:{label:t.slotName,value:t.slotName}})}),1):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curSlotIndex,expression:"scope.$index !== curSlotIndex "}]},[t._v(" "+t._s(e.row.slotName))])]}}])}),n("el-table-column",{attrs:{label:"实体名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(" "+t._s(e.row.entityName)+" ")])]}}])}),n("el-table-column",{attrs:{prop:"isArray",label:"数组",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.isArray,callback:function(n){t.$set(e.row,"isArray",n)},expression:"scope.row.isArray"}})]}}])}),n("el-table-column",{attrs:{prop:"reAsk",label:"话术",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-edit",on:{click:function(n){return t.addUtts("inform",e.$index)}}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curSlotIndex,expression:"scope.$index === curSlotIndex"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveSlot(e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curSlotIndex,expression:"scope.$index !== curSlotIndex "}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editSlot(e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.delSlot(e.$index)}}})]}}])})],1),t._v("\n                \n                  "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addSlot}},[t._v("添加收集槽位")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[t._m(2),n("div",{staticClass:"ef-confirm-lst"},[t._l(t.confirmConfig,function(e,i){return n("div",{key:i,staticStyle:{border:"2px solid lightgrey","border-radius":"10px",margin:"5px 10px",padding:"5px 0px"}},[n("div",{staticStyle:{"text-align":"right","padding-right":"5px"}},[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.deleteConfirmItem(i)}}})],1),n("el-form",{ref:"form",refInFor:!0,attrs:{model:e,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"最大确认次数: "}},[n("el-input",{staticStyle:{width:"200px"},model:{value:e.maxConfirmNo,callback:function(n){t.$set(e,"maxConfirmNo",n)},expression:"confirm.maxConfirmNo"}})],1),n("el-form-item",{attrs:{label:"机器人动作名: "}},[n("el-input",{staticStyle:{width:"200px"},model:{value:e.nlgActName,callback:function(n){t.$set(e,"nlgActName",n)},expression:"confirm.nlgActName"}})],1),n("el-form-item",{attrs:{label:"确认话术: "}},[n("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea"},model:{value:e.nlgTemplate,callback:function(n){t.$set(e,"nlgTemplate",n)},expression:"confirm.nlgTemplate"}})],1),n("el-form-item",{attrs:{label:"确认槽位列表"}},[t._l(e.slots,function(e){return n("el-tag",{key:e.slotId,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleConfirmSlotClose(i,e.slotId)}}},[t._v("\n                                "+t._s(e.slotName)+"\n                            ")])}),t.inputConfirmSlot?n("el-select",{ref:"confirmInput",refInFor:!0,staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:function(e){return t.handleConfirmSlotInputConfirm(i)}},model:{value:t.confirmSlotName,callback:function(e){t.confirmSlotName=e},expression:"confirmSlotName"}},t._l(t.curSlotList,function(t){return n("el-option",{key:t.slotId,attrs:{label:t.slotName,value:t.slotName}})}),1):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.showConfirmSlotInput(i)}}},[t._v("+ 确认槽位")])],2)],1)],1)}),n("div",{staticStyle:{"text-align":"left","padding-left":"20px","margin-top":"10px"}},[n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.addConfirmItem}}),t._v(" 添加确认话术\n                ")],1)],2),t._m(3),n("after-set",{attrs:{userId:t.userId,botId:t.botId,operations:t.afterSettings}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])])]),n("el-dialog",{attrs:{title:"定义话术",visible:t.showUttEdit,modal:!1,width:"80%"},on:{"update:visible":function(e){t.showUttEdit=e}}},[n("div",{staticStyle:{height:"420px",overflow:"scroll"}},[n("el-form",[n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Inform 话术: ")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.info_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform"===t.curUttType,expression:"scope.$index === curUttIndex && curUttType === 'inform'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Request 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.req_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'request'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"request"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'request'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("request",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"request"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'request'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("request",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("request",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("request")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Confirm 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.confirm_utts,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'confirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"confirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'confirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("confirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"confirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'confirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("confirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("confirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("confirm")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Disconfirm 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.disconfirm,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'disconfirm'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"disconfirm"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'disconfirm'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("disconfirm",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"disconfirm"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'disconfirm'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("disconfirm",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("disconfirm",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("disconfirm")}}},[t._v("+ 增加话术")])],1)]),n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("Inform Add 话术:")])])]),n("div",[n("div",{staticStyle:{display:"inline-block"}},[n("el-table",{attrs:{data:t.curUtts.inform_add,"max-height":"120px",size:"mini","show-header":!1,border:""}},[n("el-table-column",{attrs:{width:"480px;",prop:"utt"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],attrs:{size:"mini"},model:{value:e.row.utt,callback:function(n){t.$set(e.row,"utt",n)},expression:"scope.row.utt"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex  || curUttType !== 'inform_add'"}]},[t._v(" "+t._s(e.row.utt))])]}}])}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index===t.curUttIndex&&"inform_add"===t.curUttType,expression:"scope.$index === curUttIndex  && curUttType === 'inform_add'"}],staticClass:"iconfont icon-baocun",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.saveUttItem("inform_add",e.$index)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!==t.curUttIndex||"inform_add"!==t.curUttType,expression:"scope.$index !== curUttIndex || curUttType !== 'inform_add'"}],staticClass:"el-icon-edit",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.editUttItem("inform_add",e.$index)}}}),n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.deleteUttItem("inform_add",e.$index)}}})]}}])})],1),n("i",{on:{click:function(e){return t.addUttItem("inform_add")}}},[t._v("+ 增加话术")])],1)])])],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelAddUtts}},[t._v("取 消")]),n("el-button",{on:{click:t.confirmAddUtts}},[t._v("确 定")])],1)]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("槽位配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("确认配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v(" 执行后动作")])])])}],ct=(n("6b54"),n("a481"),n("ac6a"),n("7514"),n("20d6"),n("6a3b")),dt=n("8123"),ut={name:"slot-fill-form",components:{conditionPanel:tt["a"],intentInfo:ct["a"],afterSet:dt["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{expIntentShow:!1,expIntent:"",expectIntents:[],curSlotIndex:-1,editSlotName:"",curUttType:"",curUttIndex:-1,showUttEdit:!1,curUtts:[],intentList:[],visible:!0,type:"node",node:Object(J["cloneDeep"])(this.nodeInfo),tab_index:2,allSlotInfoLst:[],curSlotList:[],confirmConfig:[{slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""}],inputConfirmSlot:!1,confirmSlotName:"",curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1,afterSettings:[]}},methods:{handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},handleConfirmSlotClose:function(t,e){this.confirmConfig[t].slots.splice(this.confirmConfig[t].slots.findIndex(function(t){return t.slotId===e}),1)},showConfirmSlotInput:function(t){this.inputConfirmSlot=!0,this.$nextTick(function(t){})},handleConfirmSlotInputConfirm:function(t){var e=this.confirmSlotName;if(e){var n=this.curSlotList.find(function(t){return t.slotName===e});this.confirmConfig[t].slots.push({slotName:n.slotName,slotId:n.slotId})}this.inputConfirmSlot=!1,this.confirmSlotName=""},addConfirmItem:function(){this.confirmConfig.push({slots:[],maxConfirmNo:0,nlgTemplate:"",nlgActName:""})},deleteConfirmItem:function(t){this.confirmConfig.splice(t,1)},loadIntentInfoList:function(t,e){return this.$store.state.nlu.intentInfoList},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t},nodeInit:function(t){this.type="node",this.node=Object(J["cloneDeep"])(t),this.expectIntents=t.nodeContent.expectIntents,this.curSlotList=t.nodeContent.curSlotList,this.confirmConfig=t.nodeContent.confirmConfig,this.afterSettings=void 0!==t.nodeContent.afterSettings?t.nodeContent.afterSettings:[]},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,expectIntents:this.expectIntents,curSlotList:this.curSlotList,confirmConfig:this.confirmConfig,afterSettings:this.afterSettings},this.$emit("event:update",this.node)},addUtts:function(t,e){console.log(t+" 为槽位: "+e+"添加话术"),"inform"===t?this.curUtts=this.curSlotList[e].utts:"request"===t&&(this.curUtts=this.curReqSlotList[e].utts),console.log("当前话术为: ",this.curUtts),this.showUttEdit=!0},addSlot:function(){console.log("触发添加槽位的操作");var t={slotName:"",entityName:"",isRequie:!0,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}};this.curSlotList.push(t),this.curSlotIndex=this.curSlotList.length-1},editSlot:function(t){this.curSlotIndex=t,this.editSlotId=this.curSlotList[t].slotId},saveSlot:function(t){this.curSlotIndex=-1},handleSlotInfoConfirm:function(t){var e=this,n=this.allSlotInfoLst.find(function(t){return t.slotName===e.editSlotName});console.log("slot source: ",n),this.curSlotList[t]={slotName:n.slotName,entityName:n.entityName,isRequie:!0,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}}},delSlot:function(t){var e=this;console.log("触发移除槽位的操作"),this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curSlotList.splice(t,1),e.$message({type:"success",message:"第"+t+"个slot成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addUttItem:function(t){"inform"===t?this.curUtts.info_utts.push({utt:""}):"request"===t?this.curUtts.req_utts.push({utt:""}):"confirm"===t?this.curUtts.confirm_utts.push({utt:""}):"disconfirm"===t?this.curUtts.disconfirm.push({utt:""}):"inform_add"===t&&this.curUtts.inform_add.push({utt:""}),console.log("添加一条话术"),this.$message({type:"success",message:"增加一条"+t+"话术"})},deleteUttItem:function(t,e){var n=this,i=this;i.$confirm("将要删除当前"+t+"话术, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"inform"===t?n.curUtts.info_utts.splice(e,1):"request"===t?n.curUtts.req_utts.splice(e,1):"confirm"===t?n.curUtts.confirm_utts.splice(e,1):"disconfirm"===t?n.curUtts.disconfirm.splice(e,1):"inform_add"===t&&n.curUtts.inform_add.splice(e,1),i.$message({type:"success",message:"当前"+t+"话术成功删除"})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},editUttItem:function(t,e){console.log("触发编辑话术"),this.curUttType=t,this.curUttIndex=e,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},saveUttItem:function(t,e){console.log("触发保存话术"),this.curUttType="",this.curUttIndex=-1,console.log(" curUttType: "+this.curUttType+" curUttIndex: "+this.curUttIndex)},cancelAddUtts:function(){this.showUttEdit=!1},confirmAddUtts:function(){this.showUttEdit=!1},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}}},watch:{},mounted:function(){this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId),this.allSlotInfoLst=this.buildAllSlotConfLst()}},pt=ut,ft=(n("096f"),Object(c["a"])(pt,lt,rt,!1,null,null,null)),ht=ft.exports,mt=n("6d28"),xt=n("6914"),vt=n("971d"),bt=n("eb3b"),gt=n("d828"),yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticStyle:{"border-top":"0px 0px 1px 0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticStyle:{padding:"5px 10px 5px 10px"}},[t._l(t.expectIntents,function(e){return n("el-tag",{key:e.intentId,staticStyle:{"margin-left":"5px","margin-top":"5px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return t.handleExpIntentClose(e.intentId)}}},[t._v("\n                    "+t._s(e.intentName)+"\n                    ")])}),t._v("  \n                \n\n                "),t.expIntentShow?n("el-select",{ref:"expIntentInput",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:t.handleExpIntentConfirm},model:{value:t.expIntent,callback:function(e){t.expIntent=e},expression:"expIntent"}},[t._l(t.intentList,function(t){return n("el-option",{key:t.intentId,attrs:{label:t.intentName,value:t.intentName}})}),n("el-option",{attrs:{label:"新建意图",value:"newIntent"}})],2):n("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:t.showExpIntentInput}},[t._v("+ 期望意图")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(1),n("div",{staticClass:"ef-edit-func"},[n("el-form",{ref:"form",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"服务"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"small"},model:{value:t.serviceName,callback:function(e){t.serviceName=e},expression:"serviceName"}})],1),n("el-form-item",{attrs:{label:"函数"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"small"},model:{value:t.funcName,callback:function(e){t.funcName=e},expression:"funcName"}})],1)],1)],1),t._m(2),n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"配置定时任务激活后的话术","show-icon":""}}),n("div",{staticClass:"ef-intent ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 机器人动作名: ")]),t._v("\n                  \n                "),n("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入机器人动作名",size:"small"},model:{value:t.active_resp_action,callback:function(e){t.active_resp_action=e},expression:"active_resp_action"}})],1),n("div",{staticClass:"ef-resp-type ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 回复类型: ")]),t._v("\n                         \n                "),n("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"请选择回复类型"},model:{value:t.active_resp_type,callback:function(e){t.active_resp_type=e},expression:"active_resp_type"}},t._l(t.responseTypeList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),n("div",{staticClass:"ef-query ef-sub-section"},[t._v("\n                  \n                "),n("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("* 机器人回复:   ")]),t._v("\n                  \n                "),n("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",rows:2,placeholder:"输入机器人回复",size:"small"},model:{value:t.active_resp_template,callback:function(e){t.active_resp_template=e},expression:"active_resp_template"}})],1),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"配置定时任务激活后的回复话术的动作","show-icon":""}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.active_action_list,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.delActiveAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addActiveAction}},[t._v("添加对话动作")])],1),t._m(3),n("div",{staticClass:"ef-intent ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 机器人动作名: ")]),t._v("\n                  \n                "),n("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入机器人动作名",size:"small"},model:{value:t.notify_resp_action,callback:function(e){t.notify_resp_action=e},expression:"notify_resp_action"}})],1),n("div",{staticClass:"ef-resp-type ef-sub-section"},[t._v("\n                  \n                "),n("span",[t._v("* 回复类型: ")]),t._v("\n                         \n                "),n("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"请选择回复类型"},model:{value:t.notify_resp_type,callback:function(e){t.notify_resp_type=e},expression:"notify_resp_type"}},t._l(t.responseTypeList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),n("div",{staticClass:"ef-query ef-sub-section"},[t._v("\n                  \n                "),n("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("* 机器人回复:   ")]),t._v("\n                  \n                "),n("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",rows:2,placeholder:"输入机器人回复",size:"small"},model:{value:t.notify_resp_template,callback:function(e){t.notify_resp_template=e},expression:"notify_resp_template"}})],1),n("div",{staticClass:"ef-table ef-sub-section"},[n("el-alert",{staticStyle:{margin:"5px 10px 5px 10px",width:"95%"},attrs:{closable:!1,title:"",type:"info",description:"配置定时任务激活后的回复话术的动作","show-icon":""}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.notify_action_list,"max-height":"200",size:"small"}},[n("el-table-column",{attrs:{prop:"action",label:"对话动作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.action,callback:function(n){t.$set(e.row,"action",n)},expression:"scope.row.action"}},t._l(t.actionOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}])}),n("el-table-column",{attrs:{prop:"slotOp",label:"槽位运算符"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotOp,callback:function(n){t.$set(e.row,"slotOp",n)},expression:"scope.row.slotOp"}},[n("el-option",{attrs:{label:"=",value:"="}}),n("el-option",{attrs:{label:"!=",value:"!="}})],1)]}}])}),n("el-table-column",{attrs:{prop:"slotName",label:"关联槽位"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.row.slotName,callback:function(n){t.$set(e.row,"slotName",n)},expression:"scope.row.slotName"}},[t._l(t.allSlotInfoLst,function(t){return n("el-option",{key:t.slotName,attrs:{label:t.slotName,value:t.slotName}})}),n("el-option",{attrs:{label:"无槽位",value:""}})],2)]}}])}),n("el-table-column",{attrs:{label:"删除",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return t.delNotifyAction(e.$index)}}})]}}])})],1),t._v("\n                    "),n("i",{staticClass:"el-icon-plus",staticStyle:{color:"steelblue"},on:{click:t.addNotifyAction}},[t._v("添加对话动作")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[t._m(4),n("div",{staticClass:"ef-condition ef-sub-section"})])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1),n("el-dialog",{attrs:{title:"编辑意图",visible:t.showIntentEditDialog,width:"85%","before-close":t.handleIntentEditDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.showIntentEditDialog=e}}},[n("intent-info",{attrs:{userId:t.userId,botId:t.botId,intentInfo:t.curIntentInfo},on:{updateIntent:t.handleIntentInfoChange,cancelIntent:t.handleIntentEditCancel}})],1)],1)},_t=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("期望意图")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("定时任务函数")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("定时任务激活话术")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("定时任务完成话术")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("转移分支")])])])}],It={name:"time-form",components:{conditionPanel:tt["a"],intentInfo:ct["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{tab_index:2,visible:!0,type:"node",node:Object(J["cloneDeep"])(this.nodeInfo),expIntentShow:!1,expIntent:"",expectIntents:[],serviceName:"",funcName:"",intentList:[],allSlotInfoLst:[],actionOptions:["inform","deform","confirm","request","negate","yn","deny","dontcare","reqmore","repeat","change"],responseTypeList:["文本回复","卡片回复","选择列表","是否按钮"],active_resp_action:"",active_resp_type:"",active_resp_template:"",active_action_list:[],notify_resp_action:"",notify_resp_type:"",notify_resp_template:"",notify_action_list:[],curIntentInfo:{},curIntentIndex:-1,showIntentEditDialog:!1}},methods:{nodeInit:function(t){this.type="node",this.node=Object(J["cloneDeep"])(t),console.log("加载的 node 信息为:",t),this.expectIntents=t.nodeContent.expectIntents,this.serviceName=t.nodeContent.serviceName,this.funcName=t.nodeContent.funcName,this.active_resp_action=t.nodeContent.active_resp_action,this.active_resp_type=t.nodeContent.active_resp_type,this.active_resp_template=t.nodeContent.active_resp_template,this.active_action_list=t.nodeContent.active_action_list,this.notify_resp_action=t.nodeContent.notify_resp_action,this.notify_resp_type=t.nodeContent.notify_resp_type,this.notify_resp_template=t.nodeContent.notify_resp_template,this.notify_action_list=t.nodeContent.notify_action_list},editFuncHandle:function(){},showCodeHandle:function(){},handleExpIntentClose:function(t){this.expectIntents.splice(this.expectIntents.findIndex(function(e){return e.intentId===t}),1)},showExpIntentInput:function(){this.expIntentShow=!0,this.$nextTick(function(t){})},handleExpIntentConfirm:function(){var t=this.expIntent;if(t)if("newIntent"===t)this.addIntentInfo();else{var e=this.intentList.find(function(e){return e.intentName===t});this.expectIntents.push({intentName:e.intentName,intentId:e.intentId})}this.expIntentShow=!1,this.expIntent=""},loadIntentInfoList:function(t,e){return console.log("回复节点加载意图列表: ",this.$store.state.nlu.intentInfoList),this.$store.state.nlu.intentInfoList},buildAllSlotConfLst:function(){var t=[];return this.intentList.forEach(function(e){e.slotInfoLst.forEach(function(e){t.push({slotName:e.slotName,entityName:e.slotSource,isArray:!1,utts:{info_utts:[],req_utts:[],confirm_utts:[],disconfirm:[],inform_add:[]}})})}),t},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete",this.node.id)},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,expectIntents:this.expectIntents,serviceName:this.serviceName,funcName:this.funcName,active_resp_action:this.active_resp_action,active_resp_type:this.active_resp_type,active_resp_template:this.active_resp_template,active_action_list:this.active_action_list,notify_resp_action:this.notnotify_resp_action,notify_resp_type:this.notify_resp_type,notify_resp_template:this.notify_resp_template,notify_action_list:this.notify_action_list},this.$emit("event:update",this.node)},createInentHandle:function(){console.log("触发创建新意图事件"),this.$emit("event:createIntent")},createQueryHandle:function(){console.log("触发创建新的例句事件"),this.$emit("event:createQuery")},addAction:function(){console.log("触发添加动作的操作"),this.curActionList.push({action:"",slotOp:"",slotName:""})},deleteAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curActionList.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addActiveAction:function(){console.log("触发添加动作的操作"),this.active_action_list.push({action:"",slotOp:"",slotName:""})},delActiveAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.active_action_list.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},addNotifyAction:function(){console.log("触发添加动作的操作"),this.notify_action_list.push({action:"",slotOp:"",slotName:""})},delNotifyAction:function(t){var e=this;this.$confirm("将要删除该动作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.notify_action_list.splice(t,1),e.$message({type:"success",message:"第"+t+"个动作成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},editIntentInfo:function(t){var e=this.intentList.findIndex(function(e){return e.intentId===t});console.log("UserForm 新建问句, 传入的意图名为: ",t," 索引为: ",e),this.showIntentEditDialog=!0,this.curIntentInfo=this.intentList[e]},addIntentInfo:function(){console.log("创建新意图"),this.showIntentEditDialog=!0,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"intent_"+this.UUID(),userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditDialogClose:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentInfoChange:function(t){console.log("intent idx: "+this.curIntentIndex),this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}},handleIntentEditCancel:function(){this.showIntentEditDialog=!1,this.curIntentInfo=void 0,this.curIntentInfo={intentName:"",intentId:"",userId:this.userId,botId:this.botId,queryLst:[],slotInfoLst:[],regLst:[]}}},watch:{},mounted:function(){this.nodeInit(this.nodeInfo),this.intentList=this.loadIntentInfoList(this.userId,this.botId),this.allSlotInfoLst=this.buildAllSlotConfLst()}},wt=It,kt=(n("ba68"),Object(c["a"])(wt,yt,_t,!1,null,"7c541f43",null)),Ct=kt.exports,Nt=(n("2f62"),n("eee3")),St={name:"graphcanvas",components:{flowNode:Z,drawer:g,MiniMap:q,baseForm:st,userForm:ot["a"],botForm:at["a"],slotFillForm:ht,funcForm:mt["a"],switchForm:xt["a"],startForm:vt["a"],endForm:bt["a"],subBotForm:gt["a"],timeForm:Ct},props:{userId:{type:String,default:"u1"},botId:{type:String,default:"b1"},taskId:{type:String,default:"t1"},taskName:{type:String,default:"tn1"},jsp:{type:Object},pos:{type:Array}},computed:{nodeFormName:function(){if(void 0!==this.info&&void 0!=this.info.className){var t=this.info.className,e={start:"startForm",end:"endForm",user:"userForm",bot:"botForm",func:"funcForm",switch:"switchForm",subbot:"subBotForm",slot:"slotFillForm",time:"timeForm"};return e[t]}},formTitle:function(){if(void 0!==this.info&&void 0!=this.info.className){var t=this.info.className,e={start:"开始节点",end:"终止节点",user:"用户对话节点",bot:"回复节点",func:"函数计算节点",switch:"分支节点",subbot:"子对话流节点",slot:"槽位填充节点"};return e[t]}return"未定义节点"},nodeSize:function(){return"width: "+width+"px; height: "+hieght+"px;"},datas:{get:function(){return this.$store.state.task.taskFlow},set:function(t){this.datas=t}},nodes:{get:function(){return this.$store.state.task.taskFlow.nodes},set:function(t){this.nodes=t}}},watch:{zoom_val:{handler:function(t,e){var n=this;this.$nextTick(function(t){n.scaleCanvas()})},deep:!0}},data:function(){return{zoom_val:0,canvas_pos:{top:"",left:""},canvas_size:{width:"2000px",height:"2000px"},dialogVisible:!1,dialogTitle:"",dialogText:"",info:void 0,side_display:!1,show_minimap:!1,rjsp:this.$jsplumb.getInstance({ConnectionOverlays:[["Arrow",{location:1,id:"arrow",width:11,length:11}],["Label",{location:.3,id:"label",cssClass:"jsp-label"}]]}),isDefault:!1,startNodeId:"",canvas_isDown:!1,canvas_initialLeft:0,canvas_initialTop:0,canvas_divLeft:0,canvas_divTop:0}},methods:{onContextmenu:function(t,e){var n=this;this.$contextmenu({items:[{label:"复制",disabled:!1,onClick:function(){console.log("触发节点复制事件: ",e.nodeName),console.log("触发复制节点的内容为: ",e)}},{label:"黏贴",disabled:!0},{label:"删除",disable:!1,onClick:function(){console.log("触发删除节点事件",e),console.log("触发删除节点的内容为",e),n.nodeDelete(e)}}],event:t,zIndex:3,minWidth:140}),t.preventDefault()},toggle_side:function(){this.side_display=!this.side_display},toggle_map:function(){this.show_minimap=!this.show_minimap},init:function(){var t=this;this.jsp.droppable(this.$refs.right,{drop:this._jspDrop}),this.rjsp.reset(),this.rjsp.bind("beforeDrop",this._jspBeforeDrop),this.rjsp.importDefaults({ConnectionsDetachable:!1});var e=this;this.rjsp.bind("dblclick",function(t,n){console.log("接收到双击连接的事件"),e.$confirm("将要删除当前连接, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.rjsp.deleteConnection(t),e.$store.commit("task/DEL_EDGE",t),e.saveDatas(),e.$message({type:"success",message:"当前节点成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}),this.$nextTick(function(){t._fetch_data({userId:t.userId,botId:t.botId,taskId:t.taskId},!0)})},_jspDrop:function(t){var e=this;this.info=t;var n=this._createNode(this.info.drag.el,this.info.drop.el);this.$store.dispatch("task/saveNode",n),this.$nextTick(function(t){return e._initNode(e.$refs.nodes[e.nodes.length-1])}),this.info=n,this.openDialog(this.info)},_jspBeforeDrop:function(t){t.targetId=t.dropEndpoint.elementId;var e=this.rjsp.getConnections({source:t.sourceId,target:t.targetId});0===e.length?(this.info=t,this._addEdge(this.info)):this.$message({message:"当前边已经存在,不允许重复连接",type:"warning",duration:1500})},openDialog:function(t){this.dialogVisible=!0,console.log("当前编辑节点的ID :",t.nodeId),console.log("当前编辑节点的Name :",t.nodeName),console.log("当点的form 名称为: "+this.nodeFormName)},closeDialog:function(){this.dialogTitle="",this.dialogText="",this.dialogVisible=!1,this.info=void 0},editNodeText:function(t){this.closeDialog(),this.dialogText=t.nodeName,this.info=t,console.log("当前编辑节点的ID :",t.nodeId),this.openDialog(t)},editLabelText:function(t){this.dialogText=t.labelText,this.info=t.component,console.log("触发链接标签编辑事件，目前未定义动作")},summit:function(t){console.log("接收到保存内容: "+t.nodeContent.desc),this.info=t,this.$store.dispatch("task/saveNode",t),this.closeDialog()},saveDatas:function(){var t=this,e={nodes:this.nodes.map(function(e,n){return e.style=t._getStyle(t.$refs.nodes[n]),console.log("当前节点的类型为: ",e.type),"start"===e.type&&(t.isDefault=e.default_taskflow,console.log("当前对话流是否为起始对话流{}".format(t.isDefault))),e}),edges:this.rjsp.getAllConnections().map(function(t){return{source:t.sourceId,target:t.targetId,labelText:t.getOverlay("label").labelText}}),startNodeId:this.startNodeId,isDefault:this.isDefault};this.$store.dispatch("task/updateTaskFlow",e)},saveTaskflow:function(){var t=this,e={nodes:this.nodes.map(function(e,n){return e.style=t._getStyle(t.$refs.nodes[n]),e}),edges:this.rjsp.getAllConnections().map(function(t){return{source:t.sourceId,target:t.targetId,labelText:t.getOverlay("label").labelText}}),startNodeId:this.startNodeId,isDefault:this.isDefault,canvasSize:this.canvas_size},n={userId:this.userId,botId:this.botId,taskId:this.taskId,taskName:this.taskName,taskFlow:e};console.log("保存对话流， 当前画布尺寸为: ",e.canvasSize.height," ",e.canvasSize.width),this.$store.dispatch("task/saveTaskFlow",n),this.$message({type:"success",message:"当前对话流保存成功!"})},_getStyle:function(t){var e=this.$refs.right.getBoundingClientRect(),n=t.getBoundingClientRect();return{left:n.left-e.left-t.clientLeft+4+"px",top:n.top-e.top-t.clientTop+1+"px",lineHeight:t.clientHeight+"px",borderLeftColor:t.style.borderLeftColor}},_shift_node:function(t,e){var n=this.$refs.right.getBoundingClientRect(),i=t.getBoundingClientRect();return{left:i.left-n.left-t.clientLeft+4+e+"px",top:i.top-n.top-t.clientTop+1+"px",lineHeight:t.clientHeight+"px",borderLeftColor:t.style.borderLeftColor}},_shift_nodes:function(t){var e=this;this.datas={nodes:this.nodes.map(function(n,i){return n.style=e._shift_node(e.$refs.nodes[i],t),n}),edges:this.rjsp.getAllConnections().map(function(t){return{source:t.sourceId,target:t.targetId,labelText:t.getOverlay("label").labelText}})},this.nodes=this.datas.nodes,this.$nextTick(function(t){e._initNodes(e.$refs.nodes),e._initEdges(e.datas.edges)})},clearAll:function(){console.log("清空画布"),this.rjsp.reset(),this.$store.commit("task/SET_TASKFLOW",{nodes:[],edges:[],startNodeId:"",isDefault:!1});this.userId,this.botId,this.taskId},reload:function(){var t=this;this.clearAll(),this.rjsp.bind("beforeDrop",this._jspBeforeDrop),this.rjsp.importDefaults({ConnectionsDetachable:!1});var e=this;this.rjsp.bind("dblclick",function(t,n){console.log("接收到双击连接的事件"),e.$confirm("将要删除当前连接, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.rjsp.deleteConnection(t),e.$store.commit("task/DEL_EDGE",t),e.saveDatas(),e.$message({type:"success",message:"当前节点成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}),this._fetch_data({userId:this.userId,botId:this.botId,taskId:this.taskId},!1),console.log("重载节点: ",this.$refs.nodes,this.datas.edges,this.datas),this.$nextTick(function(e){t._initNodes(t.$refs.nodes),t._initEdges(t.datas.edges)})},refresh:function(){var t=this;console.log("调用刷新函数 "),this.rjsp.reset(),this.rjsp.bind("beforeDrop",this._jspBeforeDrop),this.rjsp.importDefaults({ConnectionsDetachable:!1});var e=this;this.rjsp.bind("dblclick",function(t,n){console.log("接收到双击连接的事件"),e.$confirm("将要删除当前连接, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.rjsp.deleteConnection(t),e.$store.commit("task/DEL_EDGE",t),e.saveDatas(),e.$message({type:"success",message:"当前边成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}),console.log("刷新节点: ",this.$refs),this.$nextTick(function(e){console.log("刷新节点: ",t.$refs.nodes),t._initNodes(t.$refs.nodes),t._initEdges(t.datas.edges)})},nodeDelete:function(t){var e=this;console.log("接收到节点删除事件!"),this.$confirm("将要删除当前节点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.remove(t),e.$message({type:"success",message:"当前节点成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},nodeDelHandle:function(){var t=this;console.log("接收到节点删除事件!"),this.$confirm("将要删除当前节点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.remove(t.info),t.$message({type:"success",message:"当前节点成功删除"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},remove:function(t){this._removeNode(t),this.closeDialog()},_removeNode:function(t){console.log("当前删除的节点: ",t);var e=this.$store.state.task.taskFlow.edges;console.log("加载所有的边!");for(var n=0;n<e.length;n++){var i=e[n];t.nodeId!==i.targetId&&t.nodeId!==i.sourceId||this._removeEgde(i)}console.log("删除边成功 !"),this.rjsp.deleteConnectionsForElement(t.nodeId),this.$store.commit("task/DEL_NODE",t),console.log("vuex 中缓存删除成功! "),this.refresh()},_removeEgde:function(t){this.rjsp.deleteConnection(t),this.$store.commit("task/DEL_EDGE",t),this.saveDatas()},_addEdge:function(t){var e=this.dialogText,n=this.rjsp.connect({source:t.sourceId,target:t.targetId},E);this.$nextTick(function(t){return n.getOverlay("label").setLabel(e)}),this.$store.commit("task/ADD_EDGE",t),this.info=void 0,this.dialogVisible=!1},_createNode:function(t,e){var n=e.getBoundingClientRect(),i=P(t.classList[0]);return console.log("初始化node 类型",t.classList[0]," 生成的nodeContent",i),{className:t.classList[0],nodeId:this.$util.uuid(),nodeName:this.dialogText,style:{left:this.pos[0]-n.left-t.clientLeft+"px  !important",top:this.pos[1]-n.top-t.clientTop+"px  !important",lineHeight:t.clientHeight+"px",borderLeftColor:w[t.classList[0]].color},iconfont_set:w[t.classList[0]],wires:[],parents:[],nodeContent:i}},_initNode:function(t){var e=this;this.rjsp.draggable(t,{constrain:!0,grid:[0,0]}),k.map(function(n){return e.rjsp.addEndpoint(t,L,{anchor:n})}),this.rjsp.makeTarget(t,{allowLoopback:!1})},_initNodes:function(t){var e=this;t.map(function(t){return e._initNode(t)})},_initEdges:function(t){var e=this;t.map(function(t){return e.rjsp.connect(t,E)})},_fetch_data:function(t,e){var n=this,i=(t.userId,t.botId,t.taskId,this);Object(Nt["h"])(t).then(function(e){var s=e["data"]["taskFlow"];console.log("load taskflow params: ",t),console.log("taskflow:",s),void 0!==s.canvasSize&&s.canvasSize!=={}?n.$nextTick(function(t){void 0!==s.canvasSize.height&&""!==s.canvasSize.height||(s.canvasSize.height="2000px"),void 0!==s.canvasSize.width&&""!==s.canvasSize.width||(s.canvasSize.width="2000px"),n.canvas_size=s.canvasSize,console.log("同步画布尺寸: height: ",n.canvas_size.height," width: ",n.canvas_size.width)}):(console.log("画布尺寸未定义: "),console.log("当前画布尺寸为: ",n.canvas_size.height," ",n.canvas_size.width)),void 0!==s||s==={}?(i.$store.commit("task/SET_TASKFLOW",s),n.$nextTick(function(t){n._initNodes(n.$refs.nodes),n._initEdges(n.datas.edges)})):i.$store.commit("task/SET_TASKFLOW",{nodes:[],edges:[],startNodeId:"",isDefault:!1})}).catch(function(t){console.log("加载函数信息失败!"),console.log(t)})},scaleCanvas:function(){var t=100+this.zoom_val,e=this.$refs["right"];e.style.top,e.style.left;if(t>=0&&t<250){var n=document.getElementById("canvas"),i="left top";n.style["transform"]="scale("+t/100+")",n.style["transformOrigin"]=i}return!1},getOppositeCoor:function(t,e){e=e||window.event;var n=e.target.parentElement,i=n.offsetLeft,s=n.offsetTop,o=n;while(o=o.offsetParent)i+=o.offsetLeft;o=n;while(o=o.offsetParent)s+=o.offsetTop;var a=e.clientX-i+document.body.scrollLeft,l=e.clientY-s+document.body.scrollTop;return{left:a,top:l}},mouseDown:function(t){console.log("触发鼠标按下事件");var e=t.target;this.canvas_isDown=!0;var n=this.getOppositeCoor("canvas",t);this.canvas_initialLeft=n.left,this.canvas_initialTop=n.top,this.canvas_divLeft=e.offsetLeft-t.target.parentElement.offsetLeft,this.canvas_divTop=e.offsetTop-t.target.parentElement.offsetTop,console.log("点击相对位置: "+this.canvas_initialLeft+" "+this.canvas_initialTop),console.log("当前元素位置: "+this.canvas_divLeft+" "+this.canvas_divTop)},mouseUp:function(t){console.log("触发鼠标抬起事件"),this.canvas_isDown=!1,this.canvas_divLeft=0,this.canvas_divTop=0,this.canvas_initialLeft=0,this.canvas_initialTop=0},mouseMove:function(t){var e=t.target;if(this.canvas_isDown){var n=this.getOppositeCoor("canvas",t),i=this.canvas_divLeft+(n.left-this.canvas_initialLeft),s=this.canvas_divTop+(n.top-this.canvas_initialTop);e.style.left=i+"px",e.style.top=s+"px";var o={left:!1,right:!1,top:!1,down:!1};if(i>5?(console.log("Left 碰撞了"),o.left=!0):o.left=!1,s>5?(console.log("Top 碰撞了"),o.top=!0):o.top=!1,i+e.offsetWidth<=e.parentElement.offsetWidth?(console.log("Right 碰撞了"),o.right=!0):o.right=!1,s+e.offsetHeight<=e.parentElement.offsetWidth?(console.log("Down 碰撞了"),o.down=!0):o.down=!1,o.down){var a=e.offsetHeight;e.style.height=a+50+"px",this.canvas_size.height=e.style.height,console.log("扩容后的 height 为: "+e.offsetHeight),console.log("扩容后 canvas_size  height:",this.canvas_size.height," width: ",this.canvas_size.width),this.$nextTick()}if(o.right){var l=e.offsetWidth;e.style.width=l+50+"px",this.canvas_size.width=e.style.width,console.log("扩容后的 width 为: "+e.offsetWidth),console.log("扩容后 canvas_size  height:",this.canvas_size.height," width: ",this.canvas_size.width)}(o.top||o.left)&&(this.canvas_isDown=!1,o.left&&(e.style.left=0),o.top&&(e.style.top=0),console.log("不允许移动"))}}},created:function(){this.canvas_size={width:"2000px",height:"2000px"}},mounted:function(){document.oncontextmenu=function(){return!1},console.log("初始化画布，当前 userId: ",this.userId," botId: ",this.botId," taskId: ",this.taskId," taskName: ",this.taskName),this.init();var t=document.getElementById("canvas");console.log("画布位置: ",t.style.top,t.style.left)},directives:{drag:{inserted:function(t,e,n){var i=document.getElementById("canvas-container"),s=t,o=n.context.$refs[e.value],a=o||document,l=o||document.body,r=s.offsetLeft,c=s.offsetTop,d=l.clientWidth,u=l.clientHeight,p=s.clientWidth,f=s.clientHeight,h=0,m=0;s.onmousedown=function(t){var e=t.clientX-s.offsetLeft+r,o=t.clientY-s.offsetTop+c;a.onmousemove=function(t){var a=t.clientX-e,l=t.clientY-o;console.log("当前画布进行移动: top: "+l+" left: "+a),l>0&&(l=0),a>0&&(a=0),a+p<d&&(p+=50),l+f<u&&(f+=50),n.context.canvas_size={width:p+"px",height:f+"px"},h=a-i.offsetLeft,m=l-i.offsetTop,s.style.left=h+"px",s.style.top=m+"px",n.context.canvas_pos={top:m+"px",left:h+"px"}},document.onmouseup=function(t){console.log("结束移动"),a.onmousemove=null,document.onmouseup=null}}}}}},$t=St,Et=(n("03a2"),Object(c["a"])($t,p,f,!1,null,"38335fee",null)),Lt=Et.exports,Tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"op-btn-panel"},[t._l(t.edit_node_lst,function(e,i){return n("div",{key:"edit_"+i,staticClass:"op-item"},[n("div",{ref:e.type,refInFor:!0,class:e.cls_arr,style:e.bordercolor},[n("el-tooltip",{staticClass:"node",attrs:{effect:"light","open-delay":t.tipOpenDelay,content:e.name,placement:"bottom"}},[n("i",{class:e.iconclass,style:e.iconstyle,on:{click:e.func}})])],1)])}),n("el-divider",{attrs:{direction:"vertical"}}),t._l(t.op_node_list,function(e,i){return n("div",{key:"op_"+i,staticClass:"op-item"},[n("div",{ref:e.type,refInFor:!0,class:e.cls_arr,style:e.bordercolor},[n("el-tooltip",{staticClass:"node",attrs:{effect:"light","open-delay":t.tipOpenDelay,content:e.name,placement:"bottom"}},[n("i",{class:e.iconclass,style:e.iconstyle,on:{click:e.func}})])],1)])}),n("el-divider",{attrs:{direction:"vertical"}}),t._l(t.search_node_lst,function(e,i){return n("div",{key:"search_"+i,staticClass:"op-item"},[n("div",{ref:e.type,refInFor:!0,class:e.cls_arr,style:e.bordercolor},[n("el-tooltip",{staticClass:"node",attrs:{effect:"light","open-delay":t.tipOpenDelay,content:e.name,placement:"bottom"}},[n("i",{class:e.iconclass,style:e.iconstyle,on:{click:e.func}})])],1)])}),n("el-divider",{attrs:{direction:"vertical"}}),t._l(t.pos_node_list,function(e,i){return n("div",{key:"pos_"+i,staticClass:"op-item"},[n("div",{ref:e.type,refInFor:!0,class:e.cls_arr,style:e.bordercolor},[n("el-tooltip",{staticClass:"node",attrs:{effect:"light","open-delay":t.tipOpenDelay,content:e.name,placement:"bottom"}},[n("i",{class:e.iconclass,style:e.iconstyle,on:{click:e.func}})])],1)])})],2)},Ut=[],zt={name:"op-btn-panel",props:{},data:function(){return{node_lst:[],edit_node_lst:[{type:"refresh",name:"刷新",cls_arr:["refresh","center"],iconclass:"el-icon-refresh",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_refresh},{type:"cut",name:"剪切",cls_arr:["save","center"],iconclass:"el-icon-scissors",iconstyle:"color:#0096ec;font-size:25px;",func:this.func_save},{type:"copy",name:"复制",cls_arr:["save","center"],iconclass:"el-icon-document-copy",iconstyle:"color:#0096ec;font-size:25px;",func:this.func_save},{type:"plaste",name:"粘贴",cls_arr:["save","center"],iconclass:"el-icon-document-add",iconstyle:"color:#0096ec;font-size:25px;",func:this.func_save},{type:"save",name:"保存",cls_arr:["save","center"],iconclass:"iconfont icon-baocun",iconstyle:"color:#0096ec;font-size:25px;",func:this.func_save},{type:"delete",name:"删除",cls_arr:["delete","center"],iconclass:"iconfont icon-shanchu1",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_del}],op_node_list:[{type:"undo",name:"undo",cls_arr:["refresh","center"],iconclass:"el-icon-refresh-left",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_refresh},{type:"redo",name:"redo",cls_arr:["refresh","center"],iconclass:"el-icon-refresh-right",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_refresh}],search_node_lst:[{type:"increment",name:"放大",cls_arr:["increment","center"],iconclass:"iconfont icon-sousuofangda",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_increment},{type:"reduce",name:"缩小",cls_arr:["reduce","center"],iconclass:"iconfont icon-sousuobianxiao",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_reduce}],pos_node_list:[{type:"location",name:"定位",cls_arr:["location","center"],iconclass:"iconfont icon-dingwei",iconstyle:"color:#0096ec; font-size: 25px;",func:this.func_location},{type:"search",name:"搜索",cls_arr:["edit","center"],iconclass:"el-icon-search",iconstyle:"color:#0096ec; font-size:25px;",func:this.func_edit}],tipOpenDelay:1e3}},methods:{func_save:function(){console.log("触发保存操作"),this.$emit("opBtnEvent","保存事件")},func_del:function(){var t=this,e=this;e.$confirm("将要永久删除当前连接, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("触发删除操作"),t.$emit("opBtnEvent","删除事件"),e.$message({type:"success",message:"当前对话流成功删除"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},func_refresh:function(){console.log("触发任务流刷新操作!");var t=this;t.$confirm("将要重新加载对话流最近一次保存的版本, 未保存的修改将被丢弃，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("触发刷新操作"),t.$emit("opBtnEvent","刷新事件"),t.$message({type:"success",message:"对话流最近一次保存版本加载成功"})}).catch(function(){t.$message({type:"info",message:"已取消对话流重载"})})},func_edit:function(){console.log("触发编辑操作"),this.$emit("opBtnEvent","编辑事件")},func_increment:function(){console.log("触发放大操作"),this.$emit("opBtnEvent","放大事件")},func_reduce:function(){console.log("触发缩小操作"),this.$emit("opBtnEvent","缩小事件")},func_location:function(){console.log("触发定位操作"),this.$emit("opBtnEvent","定位事件")},func_add:function(){console.log("触发新增操作"),this.$emit("opBtnEvent","新增事件")}}},qt=zt,Ot=(n("aea0"),Object(c["a"])(qt,Tt,Ut,!1,null,"86de43b0",null)),At=Ot.exports,Dt={name:"graph-editor",components:{NodePanel:u,GraphCanvas:Lt,OpPanel:At},props:{userId:{type:String,default:"u1"},botId:{type:String,default:"b1"},taskId:{type:String,default:"t1"},taskName:{type:String,default:"tn1"}},data:function(){return{jsp:this.$jsplumb.getInstance(),pos:[0,0]}},mounted:function(){var t={userId:this.userId,botId:this.botId};this.$store.dispatch("nlu/loadIntentList",t),this.$store.dispatch("nlu/loadEntityList",t),this.$store.dispatch("task/loadVariables",t)},methods:{updatePosition:function(t){this.pos=t},processOpBtnEvent:function(t){switch(console.log("接收到来自 op btn 组件的信号: "+t),t){case"保存事件":console.log("保存分支"),this.$refs.graphCanvas.saveTaskflow();break;case"删除事件":console.log("删除分支"),this.$refs.graphCanvas.clearAll();break;case"刷新事件":console.log("刷新分支"),this.$refs.graphCanvas.reload();break;case"编辑事件":console.log("编辑分支");break;case"放大事件":console.log("放大分支");break;case"缩小事件":console.log("缩小分支");break;case"定位事件":console.log("定位分支"),this.$refs.graphCanvas.toggle_map();break;case"新增事件":console.log("新增分支");break;default:console.log("目前还不支持 "+t+" 事件的处理");break}},clear_canvas:function(){this.$refs.graphCanvas.clearAll()},reload_canvas:function(){this.$refs.graphCanvas.reload()},processCanvasScroll:function(t){var e=t["top"],n=t["left"];console.log("接收到的位移: "+e+" "+n);var i=0==this.canvas_lastMoveLeft?0:n-this.canvas_lastMoveLeft,s=0==this.canvas_lastMoveTop?0:e-this.canvas_lastMoveTop;this.canvas_lastMoveLeft=n,this.canvas_lastMoveTop=e,console.log("上一次scroll的位置: "+this.canvas_scrollToLeft+" "+this.canvas_scrollToTop);var o=document.getElementById("graph-editor");this.canvas_scrollToLeft+=i,this.canvas_scrollToTop+=s,o.scrollTo(this.canvas_scrollToLeft,this.canvas_scrollToTop)},getOppositieCoor:function(t,e){e=e||window.event;var n=document.getElementById(t),i=n.offsetLeft,s=n.offsetTop,o=n;while(o=o.offsetParent)i+=o.offsetLeft;o=n;while(o=o.offsetParent)s+=o.offsetTop;var a=e.clientX-i+document.body.scrollLeft,l=e.clientY-s+document.body.scrollTop;return{left:a,top:l}}}},jt=Dt,Wt=(n("2e15"),Object(c["a"])(jt,i,s,!1,null,null,null));e["default"]=Wt.exports},eb3b:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-node-form"},[n("div",{staticClass:"ef-name-part"},[n("span",[t._v("名称:")]),n("el-input",{staticClass:"ef-input",attrs:{size:"small"},model:{value:t.node.nodeName,callback:function(e){t.$set(t.node,"nodeName",e)},expression:"node.nodeName"}})],1),n("div",{staticStyle:{"border-top":"0px solid lightgray",margin:"8px 0 0 0"}}),n("div",{staticClass:"ef-node-form-body"},[n("div",{staticClass:"ef-tab-container",staticStyle:{"border-bottom":"1px solid lightgrey"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey","border-left":"1px solid lightgrey"},style:{"border-bottom":1==t.tab_index?"1px solid lightblue":"1px solid white",color:1==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=1}}},[n("el-tooltip",{attrs:{content:"触发条件",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-dingwei"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":2==t.tab_index?"1px solid lightblue":"1px solid white",color:2==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=2}}},[n("el-tooltip",{attrs:{content:"功能设置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-icon_shezhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":3==t.tab_index?"1px solid lightblue":"1px solid white",color:3==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=3}}},[n("el-tooltip",{attrs:{content:"规则设定",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-yonghupeizhi"})])],1),n("div",{staticClass:"ef-tab-btn",staticStyle:{margin:"0px",width:"40px",height:"30px",display:"inline-block","text-align":"center","line-height":"30px","border-right":"1px  solid lightgrey","border-top":"1px solid lightgrey"},style:{"border-bottom":4==t.tab_index?"1px solid lightblue":"1px solid white",color:4==t.tab_index?"steelblue":"black"},on:{click:function(e){t.tab_index=4}}},[n("el-tooltip",{attrs:{content:"转移配置",placement:"bottom",effect:"light"}},[n("i",{staticClass:"iconfont icon-fenzhijiedian1"})])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tab_index,expression:"tab_index==1"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab_index,expression:"tab_index==2"}],staticClass:"ef-tab-pane"},[t._m(0),n("div",{staticClass:"ef-end-sent"},[n("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("      结束语:       ")]),n("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",rows:"2",placeholder:"输入结束语"},model:{value:t.endSentence,callback:function(e){t.endSentence=e},expression:"endSentence"}})],1),n("br"),n("div",{staticClass:"ef-end-action"},[n("span",[t._v("      结束动作:   ")]),n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.endAction,callback:function(e){t.endAction=e},expression:"endAction"}},t._l(t.endActionList,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.tab_index,expression:"tab_index==3"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==t.tab_index,expression:"tab_index==4"}],staticClass:"ef-tab-pane"},[n("span",[t._v(" 当前的面板是: "+t._s(t.tab_index))]),t._m(1),n("div",{staticClass:"ef-condition ef-sub-section"},[n("condition-panel",{attrs:{has_transition:!0,transitions:t.transition.transitions,defaultTransition:t.transition.defaultTransition}})],1)])]),n("div",{staticClass:"ef-form-buttongroup"},[n("el-button",{staticClass:"ef-form-button",attrs:{type:"danger",size:"small",plain:""},on:{click:t.deletehandle}},[t._v(" 删除")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"ef-form-button",attrs:{type:"primary",size:"small",plain:""},on:{click:t.save}},[t._v("保存")])],1)])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("结束配置")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ef-divide-bar"},[n("span",[n("b",[t._v("转移条件")])])])}],o=n("2ef0"),a=n("3095"),l={name:"end-form",components:{conditionPanel:a["a"]},props:{userId:{type:String,default:""},botId:{type:String,default:""},taskName:{type:String,default:"tn1"},nodeInfo:{type:Object,default:function(){return{text:""}}}},data:function(){return{visible:!0,type:"node",node:Object(o["cloneDeep"])(this.nodeInfo),tab_index:2,endSentence:"",endAction:"",endActionList:["结束会话","任务跳转"],transition:{}}},methods:{nodeInit:function(t){this.type="node",this.node=Object(o["cloneDeep"])(t),this.endSentence=t.nodeContent.endSentence,this.endAction=t.nodeContent.endAction,this.transition=t.nodeContent.transition},cancel:function(){this.$emit("event:cancel")},deletehandle:function(){this.$emit("event:delete")},save:function(){this.node.nodeContent={desc:"nodeType:"+this.node.className+"node Name: "+this.node.nodeName+" node id: "+this.node.nodeId,endSentence:this.endSentence,endAction:this.endAction,transition:this.transition},this.$emit("event:update",this.node)}},mounted:function(){this.nodeInit(this.nodeInfo)},watch:{}},r=l,c=(n("f596"),n("2877")),d=Object(c["a"])(r,i,s,!1,null,null,null);e["a"]=d.exports},f09b:function(t,e,n){"use strict";var i=n("5b3e"),s=n.n(i);s.a},f3a7:function(t,e,n){},f559:function(t,e,n){"use strict";var i=n("5ca1"),s=n("9def"),o=n("d2c8"),a="startsWith",l=""[a];i(i.P+i.F*n("5147")(a),"String",{startsWith:function(t){var e=o(this,t,a),n=s(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return l?l.call(e,i,n):e.slice(n,n+i.length)===i}})},f596:function(t,e,n){"use strict";var i=n("0faf"),s=n.n(i);s.a},f838:function(t,e,n){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);